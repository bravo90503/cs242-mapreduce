
 
  
   
  Latent Dirichlet allocation - Wikipedia 
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
  
 
   
   
    
   
    
    
    
    
   Latent Dirichlet allocation 
    
    
     From Wikipedia, the free encyclopedia
     
     
     
     Jump to navigation Jump to search 
    
     
      
       Probability model
       
      
      
       Not to be confused with linear discriminant analysis.
       
      
       
        
         
          
           
          
         
          
           This article may be too technical for most readers to understand. Please help improve it to make it understandable to non-experts, without removing the technical details. (August 2017) (Learn how and when to remove this template message)
          
        
       
       
      In natural language processing, the latent Dirichlet allocation (LDA) is a generative statistical model that allows sets of observations to be explained by unobserved groups that explain why some parts of the data are similar. For example, if observations are words collected into documents, it posits that each document is a mixture of a small number of topics and that each word's presence is attributable to one of the document's topics. LDA is an example of a topic model.  
      
       
       
        Contents
        
        
        1 History 
        2 Overview 
          
          2.1 Evolutionary biology and bio-medicine 
          2.2 Machine Learning 
           
        3 Model 
          
          3.1 Generative process 
          3.2 Definition 
           
        4 Inference 
          
          4.1 Monte Carlo simulation 
          4.2 Variational Bayes 
          4.3 Likelihood maximization 
          4.4 Unknown number of populations/topics 
          4.5 Alternative approaches 
          4.6 Aspects of computational details 
           
        5 Related problems 
          
          5.1 Related models 
          5.2 Spatial models 
           
        6 See also 
        7 References 
        8 External links 
        
       
      History 
      In the context of population genetics, LDA was proposed by J. K. Pritchard, M. Stephens and P. Donnelly in 2000. 
      LDA was applied in machine learning by David Blei, Andrew Ng and Michael I. Jordan in 2003.  
      Overview 
      Evolutionary biology and bio-medicine 
      In evolutionary biology and bio-medicine, the model is used to detect the presence of structured genetic variation in a group of individuals. The model assumes that alleles carried by individuals under study have origin in various extant or past populations. The model and various inference algorithms allow scientists to estimate the allele frequencies in those source populations and the origin of alleles carried by individuals under study. The source populations can be interpreted ex-post in terms of various evolutionary scenarios. In association studies, detecting the presence of genetic structure is considered a necessary preliminary step to avoid confounding.  
      Machine Learning 
      One application of LDA in machine learning - specifically, topic discovery, a subproblem in natural language processing - is to discover topics in a collection of documents, and then automatically classify any individual document within the collection in terms of how "relevant" it is to each of the discovered topics. A topic is considered to be a set of terms (i.e., individual words or phrases) that, taken together, suggest a shared theme. 
      For example, in a document collection related to pet animals, the terms dog, spaniel, beagle, golden retriever, puppy, bark, and woof would suggest a DOG_related theme, while the terms cat, siamese, main coon, tabby, manx, meow, purr, and kitten would suggest a CAT_related theme. There may be many more topics in the collection - e.g., related to diet, grooming, healthcare, behavior, etc. that we do not discuss for simplicity's sake. (Very common, so called stop words in a language - e.g., "the", "an", "that", "are", "is", etc., - would not discriminate between topics and are usually filtered out by pre-processing before LDA is performed. Pre-processing also converts terms to their "root" lexical forms - e.g., "barks", "barking", and "barked" would be converted to "bark".) 
      If the document collection is sufficiently large, LDA will discover such sets of terms (i.e., topics) based upon the co-occurrence of individual terms, though the task of assigning a meaningful label to an individual topic (i.e., that all the terms are DOG_related) is up to the user, and often requires specialized knowledge (e.g., for collection of technical documents). The LDA approach assumes that:  
      
       The semantic content of a document is composed by combining one or more terms from one or more topics. 
       Certain terms are ambiguous, belonging to more than one topic, with different probability. (For example, the term training can apply to both dogs and cats, but are more likely to refer to dogs, which are used as work animals or participate in obedience or skill competitions.) However, in a document, the accompanying presence of specific neighboring terms (which belong to only one topic) will disambiguate their usage. 
       Most documents will contain only a relatively small number of topics. In the collection, e.g., individual topics will occur with differing frequencies. That is, they have a probability distribution, so that a given document is more likely to contain some topics than others. 
       Within a topic, certain terms will be used much more frequently than others. In other words, the terms within a topic will also have their own probability distribution.
       
      When LDA machine learning is employed, both sets of probabilities are computed during the training phase, using Bayesian methods and an Expectation Maximization algorithm. 
      LDA is a generalization of older approach of Probabilistic latent semantic analysis (pLSA), The pLSA model is equivalent to LDA under a uniform Dirichlet prior distribution. pLSA relies on only the first two assumptions above and does not care about the remainder. While both methods are similar in principle and require the user to specify the number of topics to be discovered before the start of training (as with K-means clustering) LDA has the following advantages over pLSA:  
      
       LDA yields better disambiguation of words and a more precise assignment of documents to topics. 
       Computing probabilities allows a "generative" process by which a collection of new “synthetic documents” can be generated that would closely reflect the statistical characteristics of the original collection. 
       Unlike LDA, pLSA is vulnerable to overfitting especially when the size of corpus increases. 
       The LDA algorithm is more readily amenable to scaling up for large data sets using the MapReduce approach on a computing cluster.
       
      Model 
      
       
         
        
         
          
         Plate notation representing the LDA model.
        
       
      
       With plate notation, which is often used to represent probabilistic graphical models (PGMs), the dependencies among the many variables can be captured concisely. The boxes are "plates" representing replicates, which are repeated entities. The outer plate represents documents, while the inner plate represents the repeated word positions in a given document; each position is associated with a choice of topic and word. The variable names are defined as follows: 
      
       
        M denotes the number of documents
        
       
        N is number of words in a given document (document i has 
            
             
              
               
               
                N
                
                
                
                 i
                 
                
               
              
             
            
             }
             
            
           words)
        
       
        α is the parameter of the Dirichlet prior on the per-document topic distributions
        
       
        β is the parameter of the Dirichlet prior on the per-topic word distribution
        
       
        
            
             
              
               
               
                θ
                
                
                
                 i
                 
                
               
              
             
            
             }
             
            
           is the topic distribution for document i
        
       
        
            
             
              
               
               
                φ
                
                
                
                 k
                 
                
               
              
             
            
             }
             
            
           is the word distribution for topic k
        
       
        
            
             
              
               
               
                z
                
                
                
                 i
                 
                
                 j
                 
                
               
              
             
            
             }
             
            
           is the topic for the j-th word in document i
        
       
        
            
             
              
               
               
                w
                
                
                
                 i
                 
                
                 j
                 
                
               
              
             
            
             }
             
            
           is the specific word.
       
       
      
       
         
        
         
          
         Plate notation for LDA with Dirichlet-distributed topic-word distributions
        
       
       
      The fact that W is grayed out means that words 
           
            
             
              
              
               w
               
               
               
                i
                
               
                j
                
               
              
             
            
           
            }
            
           
          are the only observable variables, and the other variables are latent variables. As proposed in the original paper, a sparse Dirichlet prior can be used to model the topic-word distribution, following the intuition that the probability distribution over words in a topic is skewed, so that only a small set of words have high probability. The resulting model is the most widely applied variant of LDA today. The plate notation for this model is shown on the right, where 
           
            
             
             
              K
              
             
            
           
            
            
           
          denotes the number of topics and 
           
            
             
              
              
               φ
               
               
               
                1
                
               
              
             
              ,
              
             
              …
              
             
              ,
              
              
              
               φ
               
               
               
                K
                
               
              
             
            
           
            ,\dots ,\varphi _}
            
           
          are 
           
            
             
             
              V
              
             
            
           
            
            
           
         -dimensional vectors storing the parameters of the Dirichlet-distributed topic-word distributions (
           
            
             
             
              V
              
             
            
           
            
            
           
          is the number of words in the vocabulary). 
      It is helpful to think of the entities represented by 
           
            
             
             
              θ
              
             
            
           
            
            
           
          and 
           
            
             
             
              φ
              
             
            
           
            
            
           
          as matrices created by decomposing the original document-word matrix that represents the corpus of documents being modeled. In this view, 
           
            
             
             
              θ
              
             
            
           
            
            
           
          consists of rows defined by documents and columns defined by topics, while 
           
            
             
             
              φ
              
             
            
           
            
            
           
          consists of rows defined by topics and columns defined by words. Thus, 
           
            
             
              
              
               φ
               
               
               
                1
                
               
              
             
              ,
              
             
              …
              
             
              ,
              
              
              
               φ
               
               
               
                K
                
               
              
             
            
           
            ,\dots ,\varphi _}
            
           
          refers to a set of rows, or vectors, each of which is a distribution over words, and 
           
            
             
              
              
               θ
               
               
               
                1
                
               
              
             
              ,
              
             
              …
              
             
              ,
              
              
              
               θ
               
               
               
                M
                
               
              
             
            
           
            ,\dots ,\theta _}
            
           
         refers to a set of rows, each of which is a distribution over topics.  
      Generative process 
      To actually infer the topics in a corpus, we imagine a generative process whereby the documents are created, so that we may infer, or reverse engineer, it. We imagine the generative process as follows. Documents are represented as random mixtures over latent topics, where each topic is characterized by a distribution over all the words. LDA assumes the following generative process for a corpus 
           
            
             
             
              D
              
             
            
           
            
            
           
          consisting of 
           
            
             
             
              M
              
             
            
           
            
            
           
          documents each of length 
           
            
             
              
              
               N
               
               
               
                i
                
               
              
             
            
           
            }
            
           
         : 
      1. Choose 
           
            
             
              
              
               θ
               
               
               
                i
                
               
              
             
              ∼
              
             
              Dir
              
             
              ⁡
              
             
              (
              
             
              α
              
             
              )
              
             
            
           
            \sim \operatorname  (\alpha )}
            
           
         , where 
           
            
             
             
              i
              
             
              ∈
              
             
              {
              
             
              1
              
             
              ,
              
             
              …
              
             
              ,
              
             
              M
              
             
              }
              
             
            
           
            }
            
           
          and 
           
            
             
              
              
               D
               
              
               i
               
              
               r
               
              
             
              (
              
             
              α
              
             
              )
              
             
            
           
             (\alpha )}
            
           
          is a Dirichlet distribution with a symmetric parameter 
           
            
             
             
              α
              
             
            
           
            
            
           
          which typically is sparse (
           
            
             
             
              α
              
             
              &lt;
              
             
              1
              
             
            
           
            
            
           
         ) 
      2. Choose 
           
            
             
              
              
               φ
               
               
               
                k
                
               
              
             
              ∼
              
             
              Dir
              
             
              ⁡
              
             
              (
              
             
              β
              
             
              )
              
             
            
           
            \sim \operatorname  (\beta )}
            
           
         , where 
           
            
             
             
              k
              
             
              ∈
              
             
              {
              
             
              1
              
             
              ,
              
             
              …
              
             
              ,
              
             
              K
              
             
              }
              
             
            
           
            }
            
           
          and 
           
            
             
             
              β
              
             
            
           
            
            
           
          typically is sparse 
      3. For each of the word positions 
           
            
             
             
              i
              
             
              ,
              
             
              j
              
             
            
           
            
            
           
         , where 
           
            
             
             
              i
              
             
              ∈
              
             
              {
              
             
              1
              
             
              ,
              
             
              …
              
             
              ,
              
             
              M
              
             
              }
              
             
            
           
            }
            
           
         , and 
           
            
             
             
              j
              
             
              ∈
              
             
              {
              
             
              1
              
             
              ,
              
             
              …
              
             
              ,
              
              
              
               N
               
               
               
                i
                
               
              
             
              }
              
             
            
           
            \}}
            
           
           
      
       
        (a) Choose a topic 
            
             
              
               
               
                z
                
                
                
                 i
                 
                
                 ,
                 
                
                 j
                 
                
               
              
               ∼
               
              
               Multinomial
               
              
               ⁡
               
              
               (
               
               
               
                θ
                
                
                
                 i
                 
                
               
              
               )
               
              
               .
               
              
             
            
             \sim \operatorname  (\theta _).}
             
            
          
       
       
      
       
        (b) Choose a word 
            
             
              
               
               
                w
                
                
                
                 i
                 
                
                 ,
                 
                
                 j
                 
                
               
              
               ∼
               
              
               Multinomial
               
              
               ⁡
               
              
               (
               
               
               
                φ
                
                
                 
                 
                  z
                  
                  
                  
                   i
                   
                  
                   ,
                   
                  
                   j
                   
                  
                 
                
               
              
               )
               
              
               .
               
              
             
            
             \sim \operatorname  (\varphi _}).}
             
            
          
       
       
      (Note that multinomial distribution here refers to the multinomial with only one trial, which is also known as the categorical distribution.) 
      The lengths 
           
            
             
              
              
               N
               
               
               
                i
                
               
              
             
            
           
            }
            
           
          are treated as independent of all the other data generating variables (
           
            
             
             
              w
              
             
            
           
            
            
           
          and 
           
            
             
             
              z
              
             
            
           
            
            
           
         ). The subscript is often dropped, as in the plate diagrams shown here.  
      Definition 
      A formal description of LDA is as follows:  
       
       
        Definition of variables in the model 
        
       
         
         Variable 
         Type 
         Meaning 
         
         
         
              
               
                
                
                 K
                 
                
               
              
               
               
              
             
         integer 
         number of topics (e.g. 50) 
         
         
         
              
               
                
                
                 V
                 
                
               
              
               
               
              
             
         integer 
         number of words in the vocabulary (e.g. 50,000 or 1,000,000) 
         
         
         
              
               
                
                
                 M
                 
                
               
              
               
               
              
             
         integer 
         number of documents 
         
         
         
              
               
                
                 
                 
                  N
                  
                  
                  
                   d
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                  
                   M
                   
                  
                 
                
               
              
               }
               
              
             
         integer 
         number of words in document d 
         
         
         
              
               
                
                
                 N
                 
                
               
              
               
               
              
             
         integer 
         total number of words in all documents; sum of all 
              
               
                
                 
                 
                  N
                  
                  
                  
                   d
                   
                  
                 
                
               
              
               }
               
              
             values, i.e. 
              
               
                
                
                 N
                 
                
                 =
                 
                 
                 
                  ∑
                  
                  
                  
                   d
                   
                  
                   =
                   
                  
                   1
                   
                  
                  
                  
                   M
                   
                  
                 
                 
                 
                  N
                  
                  
                  
                   d
                   
                  
                 
                
               
              
               ^N_}
               
              
             
         
         
         
              
               
                
                 
                 
                  α
                  
                  
                  
                   k
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                  
                   K
                   
                  
                 
                
               
              
               }
               
              
             
         positive real 
         prior weight of topic k in a document; usually the same for all topics; normally a number less than 1, e.g. 0.1, to prefer sparse topic distributions, i.e. few topics per document 
         
         
         
              
               
                
                 
                 
                  α
                  
                 
                
               
              
               }}
               
              
             
         K-dimensional vector of positive reals 
         collection of all 
              
               
                
                 
                 
                  α
                  
                  
                  
                   k
                   
                  
                 
                
               
              
               }
               
              
             values, viewed as a single vector 
         
         
         
              
               
                
                 
                 
                  β
                  
                  
                  
                   w
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                  
                   V
                   
                  
                 
                
               
              
               }
               
              
             
         positive real 
         prior weight of word w in a topic; usually the same for all words; normally a number much less than 1, e.g. 0.001, to strongly prefer sparse word distributions, i.e. few words per topic 
         
         
         
              
               
                
                 
                 
                  β
                  
                 
                
               
              
               }}
               
              
             
         V-dimensional vector of positive reals 
         collection of all 
              
               
                
                 
                 
                  β
                  
                  
                  
                   w
                   
                  
                 
                
               
              
               }
               
              
             values, viewed as a single vector 
         
         
         
              
               
                
                 
                 
                  φ
                  
                  
                  
                   k
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                  
                   K
                   
                  
                   ,
                   
                  
                   w
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                  
                   V
                   
                  
                 
                
               
              
               }
               
              
             
         probability (real number between 0 and 1) 
         probability of word w occurring in topic k 
         
         
         
              
               
                
                 
                  
                  
                   φ
                   
                  
                  
                  
                   k
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                  
                   K
                   
                  
                 
                
               
              
               }_}
               
              
             
         V-dimensional vector of probabilities, which must sum to 1 
         distribution of words in topic k 
         
         
         
              
               
                
                 
                 
                  θ
                  
                  
                  
                   d
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                  
                   M
                   
                  
                   ,
                   
                  
                   k
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                  
                   K
                   
                  
                 
                
               
              
               }
               
              
             
         probability (real number between 0 and 1) 
         probability of topic k occurring in document d 
         
         
         
              
               
                
                 
                  
                  
                   θ
                   
                  
                  
                  
                   d
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                  
                   M
                   
                  
                 
                
               
              
               }_}
               
              
             
         K-dimensional vector of probabilities, which must sum to 1 
         distribution of topics in document d 
         
         
         
              
               
                
                 
                 
                  z
                  
                  
                  
                   d
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                  
                   M
                   
                  
                   ,
                   
                  
                   w
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                   
                   
                    N
                    
                    
                    
                     d
                     
                    
                   
                  
                 
                
               
              
               }}
               
              
             
         integer between 1 and K 
         identity of topic of word w in document d 
         
         
         
              
               
                
                 
                 
                  Z
                  
                 
                
               
              
                }
               
              
             
         N-dimensional vector of integers between 1 and K 
         identity of topic of all words in all documents 
         
         
         
              
               
                
                 
                 
                  w
                  
                  
                  
                   d
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                  
                   M
                   
                  
                   ,
                   
                  
                   w
                   
                  
                   =
                   
                  
                   1
                   
                  
                   …
                   
                   
                   
                    N
                    
                    
                    
                     d
                     
                    
                   
                  
                 
                
               
              
               }}
               
              
             
         integer between 1 and V 
         identity of word w in document d 
         
         
         
              
               
                
                 
                 
                  W
                  
                 
                
               
              
                }
               
              
             
         N-dimensional vector of integers between 1 and V 
         identity of all words in all documents 
        
       
       
      We can then mathematically describe the random variables as follows:  
      
       
        
            
             
              
               
                
                 
                  
                   
                    
                    
                     φ
                     
                    
                    
                    
                     k
                     
                    
                     =
                     
                    
                     1
                     
                    
                     …
                     
                    
                     K
                     
                    
                   
                  
                  
                   
                  
                   ∼
                   
                   
                   
                    Dirichlet
                    
                    
                    
                     V
                     
                    
                   
                  
                   ⁡
                   
                  
                   (
                   
                   
                   
                    β
                    
                   
                  
                   )
                   
                  
                 
                 
                  
                   
                    
                    
                     θ
                     
                    
                    
                    
                     d
                     
                    
                     =
                     
                    
                     1
                     
                    
                     …
                     
                    
                     M
                     
                    
                   
                  
                  
                   
                  
                   ∼
                   
                   
                   
                    Dirichlet
                    
                    
                    
                     K
                     
                    
                   
                  
                   ⁡
                   
                  
                   (
                   
                   
                   
                    α
                    
                   
                  
                   )
                   
                  
                 
                 
                  
                   
                   
                    z
                    
                    
                    
                     d
                     
                    
                     =
                     
                    
                     1
                     
                    
                     …
                     
                    
                     M
                     
                    
                     ,
                     
                    
                     w
                     
                    
                     =
                     
                    
                     1
                     
                    
                     …
                     
                     
                     
                      N
                      
                      
                      
                       d
                       
                      
                     
                    
                   
                  
                  
                   
                  
                   ∼
                   
                   
                   
                    Categorical
                    
                    
                    
                     K
                     
                    
                   
                  
                   ⁡
                   
                  
                   (
                   
                   
                    
                    
                     θ
                     
                    
                    
                    
                     d
                     
                    
                   
                  
                   )
                   
                  
                 
                 
                  
                   
                   
                    w
                    
                    
                    
                     d
                     
                    
                     =
                     
                    
                     1
                     
                    
                     …
                     
                    
                     M
                     
                    
                     ,
                     
                    
                     w
                     
                    
                     =
                     
                    
                     1
                     
                    
                     …
                     
                     
                     
                      N
                      
                      
                      
                       d
                       
                      
                     
                    
                   
                  
                  
                   
                  
                   ∼
                   
                   
                   
                    Categorical
                    
                    
                    
                     V
                     
                    
                   
                  
                   ⁡
                   
                  
                   (
                   
                   
                    
                    
                     φ
                     
                    
                    
                     
                     
                      z
                      
                      
                      
                       d
                       
                      
                       w
                       
                      
                     
                    
                   
                  
                   )
                   
                  
                 
                
               
              
             
            
             }_&amp;\sim \operatorname  _(})\\}_&amp;\sim \operatorname  _(})\\z_}&amp;\sim \operatorname  _(}_)\\w_}&amp;\sim \operatorname  _(}_})\end}}
             
            
          
       
       
      Inference 
      
      
       See also: Dirichlet-multinomial distribution
       
      Learning the various distributions (the set of topics, their associated word probabilities, the topic of each word, and the particular topic mixture of each document) is a problem of statistical inference.  
      Monte Carlo simulation 
      The original paper by Pritchard et al. used approximation of the posterior distribution by Monte Carlo simulation. Alternative proposal of inference techniques include Gibbs sampling.  
      Variational Bayes 
      The original ML paper used a variational Bayes approximation of the posterior distribution;  
      Likelihood maximization 
      A direct optimization of the likelihood with a block relaxation algorithm proves to be a fast alternative to MCMC.  
      Unknown number of populations/topics 
      In practice, the optimal number of populations or topics is not known beforehand. It can be estimated by approximation of the posterior distribution with reversible-jump Markov chain Monte Carlo.  
      Alternative approaches 
      Alternative approaches include expectation propagation. 
       Recent research has been focused on speeding up the inference of latent Dirichlet allocation to support the capture of a massive number of topics in a large number of documents. The update equation of the collapsed Gibbs sampler mentioned in the earlier section has a natural sparsity within it that can be taken advantage of. Intuitively, since each document only contains a subset of topics 
           
            
             
              
              
               K
               
               
               
                d
                
               
              
             
            
           
            }
            
           
         , and a word also only appears in a subset of topics 
           
            
             
              
              
               K
               
               
               
                w
                
               
              
             
            
           
            }
            
           
         , the above update equation could be rewritten to take advantage of this sparsity.  
      
       
        
            
             
              
              
               p
               
              
               (
               
               
               
                Z
                
                
                
                 d
                 
                
                 ,
                 
                
                 n
                 
                
               
              
               =
               
              
               k
               
              
               )
               
              
               ∝
               
               
                
                 
                 
                  α
                  
                 
                  β
                  
                 
                 
                  
                  
                   C
                   
                   
                   
                    k
                    
                   
                   
                   
                    ¬
                    
                   
                    n
                    
                   
                  
                 
                  +
                  
                 
                  V
                  
                 
                  β
                  
                 
                
               
              
               +
               
               
                
                 
                  
                  
                   C
                   
                   
                   
                    k
                    
                   
                   
                   
                    d
                    
                   
                  
                 
                  β
                  
                 
                 
                  
                  
                   C
                   
                   
                   
                    k
                    
                   
                   
                   
                    ¬
                    
                   
                    n
                    
                   
                  
                 
                  +
                  
                 
                  V
                  
                 
                  β
                  
                 
                
               
              
               +
               
               
                
                 
                  
                  
                   C
                   
                   
                   
                    k
                    
                   
                   
                   
                    w
                    
                   
                  
                 
                  (
                  
                 
                  α
                  
                 
                  +
                  
                  
                  
                   C
                   
                   
                   
                    k
                    
                   
                   
                   
                    d
                    
                   
                  
                 
                  )
                  
                 
                 
                  
                  
                   C
                   
                   
                   
                    k
                    
                   
                   
                   
                    ¬
                    
                   
                    n
                    
                   
                  
                 
                  +
                  
                 
                  V
                  
                 
                  β
                  
                 
                
               
              
             
            
             =k)\propto ^+V\beta }}+^\beta }^+V\beta }}+^(\alpha +C_^)}^+V\beta }}}
             
            
          
       
       
      In this equation, we have three terms, out of which two are sparse, and the other is small. We call these terms 
           
            
             
             
              a
              
             
              ,
              
             
              b
              
             
            
           
            
            
           
          and 
           
            
             
             
              c
              
             
            
           
            
            
           
          respectively. Now, if we normalize each term by summing over all the topics, we get:  
      
       
        
            
             
              
              
               A
               
              
               =
               
               
               
                ∑
                
                
                
                 k
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 K
                 
                
               
               
                
                 
                 
                  α
                  
                 
                  β
                  
                 
                 
                  
                  
                   C
                   
                   
                   
                    k
                    
                   
                   
                   
                    ¬
                    
                   
                    n
                    
                   
                  
                 
                  +
                  
                 
                  V
                  
                 
                  β
                  
                 
                
               
              
             
            
             ^^+V\beta }}}
             
            
          
       
       
      
       
        
            
             
              
              
               B
               
              
               =
               
               
               
                ∑
                
                
                
                 k
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 K
                 
                
               
               
                
                 
                  
                  
                   C
                   
                   
                   
                    k
                    
                   
                   
                   
                    d
                    
                   
                  
                 
                  β
                  
                 
                 
                  
                  
                   C
                   
                   
                   
                    k
                    
                   
                   
                   
                    ¬
                    
                   
                    n
                    
                   
                  
                 
                  +
                  
                 
                  V
                  
                 
                  β
                  
                 
                
               
              
             
            
             ^^\beta }^+V\beta }}}
             
            
          
       
       
      
       
        
            
             
              
              
               C
               
              
               =
               
               
               
                ∑
                
                
                
                 k
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 K
                 
                
               
               
                
                 
                  
                  
                   C
                   
                   
                   
                    k
                    
                   
                   
                   
                    w
                    
                   
                  
                 
                  (
                  
                 
                  α
                  
                 
                  +
                  
                  
                  
                   C
                   
                   
                   
                    k
                    
                   
                   
                   
                    d
                    
                   
                  
                 
                  )
                  
                 
                 
                  
                  
                   C
                   
                   
                   
                    k
                    
                   
                   
                   
                    ¬
                    
                   
                    n
                    
                   
                  
                 
                  +
                  
                 
                  V
                  
                 
                  β
                  
                 
                
               
              
             
            
             ^^(\alpha +C_^)}^+V\beta }}}
             
            
          
       
       
      Here, we can see that 
           
            
             
             
              B
              
             
            
           
            
            
           
          is a summation of the topics that appear in document 
           
            
             
             
              d
              
             
            
           
            
            
           
         , and 
           
            
             
             
              C
              
             
            
           
            
            
           
          is also a sparse summation of the topics that a word 
           
            
             
             
              w
              
             
            
           
            
            
           
          is assigned to across the whole corpus. 
           
            
             
             
              A
              
             
            
           
            
            
           
          on the other hand, is dense but because of the small values of 
           
            
             
             
              α
              
             
            
           
            
            
           
          &amp; 
           
            
             
             
              β
              
             
            
           
            
            
           
         , the value is very small compared to the two other terms. 
      Now, while sampling a topic, if we sample a random variable uniformly from 
           
            
             
             
              s
              
             
              ∼
              
             
              U
              
             
              (
              
             
              s
              
              
              
               |
               
              
             
              ∣
              
             
              A
              
             
              +
              
             
              B
              
             
              +
              
             
              C
              
             
              )
              
             
            
           
            
            
           
         , we can check which bucket our sample lands in. Since 
           
            
             
             
              A
              
             
            
           
            
            
           
          is small, we are very unlikely to fall into this bucket; however, if we do fall into this bucket, sampling a topic takes 
           
            
             
             
              O
              
             
              (
              
             
              K
              
             
              )
              
             
            
           
            
            
           
          time (same as the original Collapsed Gibbs Sampler). However, if we fall into the other two buckets, we only need to check a subset of topics if we keep a record of the sparse topics. A topic can be sampled from the 
           
            
             
             
              B
              
             
            
           
            
            
           
          bucket in 
           
            
             
             
              O
              
             
              (
              
              
              
               K
               
               
               
                d
                
               
              
             
              )
              
             
            
           
            )}
            
           
          time, and a topic can be sampled from the 
           
            
             
             
              C
              
             
            
           
            
            
           
          bucket in 
           
            
             
             
              O
              
             
              (
              
              
              
               K
               
               
               
                w
                
               
              
             
              )
              
             
            
           
            )}
            
           
          time where 
           
            
             
              
              
               K
               
               
               
                d
                
               
              
             
            
           
            }
            
           
          and 
           
            
             
              
              
               K
               
               
               
                w
                
               
              
             
            
           
            }
            
           
          denotes the number of topics assigned to the current document and current word type respectively. 
      Notice that after sampling each topic, updating these buckets is all basic 
           
            
             
             
              O
              
             
              (
              
             
              1
              
             
              )
              
             
            
           
            
            
           
          arithmetic operations.  
      Aspects of computational details 
      Following is the derivation of the equations for collapsed Gibbs sampling, which means 
           
            
             
             
              φ
              
             
            
           
            
            
           
         s and 
           
            
             
             
              θ
              
             
            
           
            
            
           
         s will be integrated out. For simplicity, in this derivation the documents are all assumed to have the same length 
           
            
             
              
              
               N
               
               
               
              
             
            
           
            }
            
           
         . The derivation is equally valid if the document lengths vary. 
      According to the model, the total probability of the model is:  
      
       
        
            
             
              
              
               P
               
              
               (
               
               
               
                W
                
               
              
               ,
               
               
               
                Z
                
               
              
               ,
               
               
               
                θ
                
               
              
               ,
               
               
               
                φ
                
               
              
               ;
               
              
               α
               
              
               ,
               
              
               β
               
              
               )
               
              
               =
               
               
               
                ∏
                
                
                
                 i
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 K
                 
                
               
              
               P
               
              
               (
               
               
               
                φ
                
                
                
                 i
                 
                
               
              
               ;
               
              
               β
               
              
               )
               
               
               
                ∏
                
                
                
                 j
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 M
                 
                
               
              
               P
               
              
               (
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               ;
               
              
               α
               
              
               )
               
               
               
                ∏
                
                
                
                 t
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 N
                 
                
               
              
               P
               
              
               (
               
               
               
                Z
                
                
                
                 j
                 
                
                 ,
                 
                
                 t
                 
                
               
              
               ∣
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               )
               
              
               P
               
              
               (
               
               
               
                W
                
                
                
                 j
                 
                
                 ,
                 
                
                 t
                 
                
               
              
               ∣
               
               
               
                φ
                
                
                 
                 
                  Z
                  
                  
                  
                   j
                   
                  
                   ,
                   
                  
                   t
                   
                  
                 
                
               
              
               )
               
              
               ,
               
              
             
            
             },},},};\alpha ,\beta )=\prod _^P(\varphi _;\beta )\prod _^P(\theta _;\alpha )\prod _^P(Z_\mid \theta _)P(W_\mid \varphi _}),}
             
            
          
       
       
      where the bold-font variables denote the vector version of the variables. First, 
           
            
             
              
              
               φ
               
              
             
            
           
            }}
            
           
          and 
           
            
             
              
              
               θ
               
              
             
            
           
            }}
            
           
          need to be integrated out.  
      
       
        
            
             
              
               
                
                 
                  
                  
                  
                   P
                   
                  
                   (
                   
                   
                   
                    Z
                    
                   
                  
                   ,
                   
                   
                   
                    W
                    
                   
                  
                   ;
                   
                  
                   α
                   
                  
                   ,
                   
                  
                   β
                   
                  
                   )
                   
                  
                   =
                   
                   
                   
                    ∫
                    
                    
                    
                     θ
                     
                    
                   
                   
                   
                    ∫
                    
                    
                    
                     φ
                     
                    
                   
                  
                   P
                   
                  
                   (
                   
                   
                   
                    W
                    
                   
                  
                   ,
                   
                   
                   
                    Z
                    
                   
                  
                   ,
                   
                   
                   
                    θ
                    
                   
                  
                   ,
                   
                   
                   
                    φ
                    
                   
                  
                   ;
                   
                  
                   α
                   
                  
                   ,
                   
                  
                   β
                   
                  
                   )
                   
                   
                  
                   d
                   
                   
                   
                    φ
                    
                   
                   
                  
                   d
                   
                   
                   
                    θ
                    
                   
                  
                 
                 
                  
                  
                   =
                   
                   
                   
                  
                  
                   
                   
                   
                    ∫
                    
                    
                    
                     φ
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                  
                   P
                   
                  
                   (
                   
                   
                   
                    φ
                    
                    
                    
                     i
                     
                    
                   
                  
                   ;
                   
                  
                   β
                   
                  
                   )
                   
                   
                   
                    ∏
                    
                    
                    
                     j
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     M
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     t
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     N
                     
                    
                   
                  
                   P
                   
                  
                   (
                   
                   
                   
                    W
                    
                    
                    
                     j
                     
                    
                     ,
                     
                    
                     t
                     
                    
                   
                  
                   ∣
                   
                   
                   
                    φ
                    
                    
                     
                     
                      Z
                      
                      
                      
                       j
                       
                      
                       ,
                       
                      
                       t
                       
                      
                     
                    
                   
                  
                   )
                   
                   
                  
                   d
                   
                   
                   
                    φ
                    
                   
                   
                   
                    ∫
                    
                    
                    
                     θ
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     j
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     M
                     
                    
                   
                  
                   P
                   
                  
                   (
                   
                   
                   
                    θ
                    
                    
                    
                     j
                     
                    
                   
                  
                   ;
                   
                  
                   α
                   
                  
                   )
                   
                   
                   
                    ∏
                    
                    
                    
                     t
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     N
                     
                    
                   
                  
                   P
                   
                  
                   (
                   
                   
                   
                    Z
                    
                    
                    
                     j
                     
                    
                     ,
                     
                    
                     t
                     
                    
                   
                  
                   ∣
                   
                   
                   
                    θ
                    
                    
                    
                     j
                     
                    
                   
                  
                   )
                   
                   
                  
                   d
                   
                   
                   
                    θ
                    
                   
                  
                   .
                   
                  
                 
                
               
              
             
            
             &amp;P(},};\alpha ,\beta )=\int _}\int _}P(},},},};\alpha ,\beta )\,d}\,d}\\=&amp;\int _}\prod _^P(\varphi _;\beta )\prod _^\prod _^P(W_\mid \varphi _})\,d}\int _}\prod _^P(\theta _;\alpha )\prod _^P(Z_\mid \theta _)\,d}.\end}}
             
            
          
       
       
      All the 
           
            
             
             
              θ
              
             
            
           
            
            
           
         s are independent to each other and the same to all the 
           
            
             
             
              φ
              
             
            
           
            
            
           
         s. So we can treat each 
           
            
             
             
              θ
              
             
            
           
            
            
           
          and each 
           
            
             
             
              φ
              
             
            
           
            
            
           
          separately. We now focus only on the 
           
            
             
             
              θ
              
             
            
           
            
            
           
          part.  
      
       
        
            
             
              
               
               
                ∫
                
                
                
                 θ
                 
                
               
               
               
                ∏
                
                
                
                 j
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 M
                 
                
               
              
               P
               
              
               (
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               ;
               
              
               α
               
              
               )
               
               
               
                ∏
                
                
                
                 t
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 N
                 
                
               
              
               P
               
              
               (
               
               
               
                Z
                
                
                
                 j
                 
                
                 ,
                 
                
                 t
                 
                
               
              
               ∣
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               )
               
               
              
               d
               
               
               
                θ
                
               
              
               =
               
               
               
                ∏
                
                
                
                 j
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 M
                 
                
               
               
               
                ∫
                
                
                 
                 
                  θ
                  
                  
                  
                   j
                   
                  
                 
                
               
              
               P
               
              
               (
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               ;
               
              
               α
               
              
               )
               
               
               
                ∏
                
                
                
                 t
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 N
                 
                
               
              
               P
               
              
               (
               
               
               
                Z
                
                
                
                 j
                 
                
                 ,
                 
                
                 t
                 
                
               
              
               ∣
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               )
               
               
              
               d
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               .
               
              
             
            
             }\prod _^P(\theta _;\alpha )\prod _^P(Z_\mid \theta _)\,d}=\prod _^\int _}P(\theta _;\alpha )\prod _^P(Z_\mid \theta _)\,d\theta _.}
             
            
          
       
       
      We can further focus on only one 
           
            
             
             
              θ
              
             
            
           
            
            
           
          as the following:  
      
       
        
            
             
              
               
               
                ∫
                
                
                 
                 
                  θ
                  
                  
                  
                   j
                   
                  
                 
                
               
              
               P
               
              
               (
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               ;
               
              
               α
               
              
               )
               
               
               
                ∏
                
                
                
                 t
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 N
                 
                
               
              
               P
               
              
               (
               
               
               
                Z
                
                
                
                 j
                 
                
                 ,
                 
                
                 t
                 
                
               
              
               ∣
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               )
               
               
              
               d
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               .
               
              
             
            
             }P(\theta _;\alpha )\prod _^P(Z_\mid \theta _)\,d\theta _.}
             
            
          
       
       
      Actually, it is the hidden part of the model for the 
           
            
             
              
              
               j
               
               
               
                t
                
               
                h
                
               
              
             
            
           
            }
            
           
          document. Now we replace the probabilities in the above equation by the true distribution expression to write out the explicit equation.  
      
       
        
            
             
              
               
               
                ∫
                
                
                 
                 
                  θ
                  
                  
                  
                   j
                   
                  
                 
                
               
              
               P
               
              
               (
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               ;
               
              
               α
               
              
               )
               
               
               
                ∏
                
                
                
                 t
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 N
                 
                
               
              
               P
               
              
               (
               
               
               
                Z
                
                
                
                 j
                 
                
                 ,
                 
                
                 t
                 
                
               
              
               ∣
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               )
               
               
              
               d
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               =
               
               
               
                ∫
                
                
                 
                 
                  θ
                  
                  
                  
                   j
                   
                  
                 
                
               
               
                
                 
                 
                  Γ
                  
                  
                  
                   (
                   
                   
                    
                    
                     ∑
                     
                     
                     
                      i
                      
                     
                      =
                      
                     
                      1
                      
                     
                     
                     
                      K
                      
                     
                    
                    
                    
                     α
                     
                     
                     
                      i
                      
                     
                    
                   
                  
                   )
                   
                  
                 
                 
                  
                  
                   ∏
                   
                   
                   
                    i
                    
                   
                    =
                    
                   
                    1
                    
                   
                   
                   
                    K
                    
                   
                  
                 
                  Γ
                  
                 
                  (
                  
                  
                  
                   α
                   
                   
                   
                    i
                    
                   
                  
                 
                  )
                  
                 
                
               
               
               
                ∏
                
                
                
                 i
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 K
                 
                
               
               
               
                θ
                
                
                
                 j
                 
                
                 ,
                 
                
                 i
                 
                
                
                 
                 
                  α
                  
                  
                  
                   i
                   
                  
                 
                
                 −
                 
                
                 1
                 
                
               
               
               
                ∏
                
                
                
                 t
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 N
                 
                
               
              
               P
               
              
               (
               
               
               
                Z
                
                
                
                 j
                 
                
                 ,
                 
                
                 t
                 
                
               
              
               ∣
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               )
               
               
              
               d
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               .
               
              
             
            
             }P(\theta _;\alpha )\prod _^P(Z_\mid \theta _)\,d\theta _=\int _}^\alpha _\right)}^\Gamma (\alpha _)}}\prod _^\theta _^-1}\prod _^P(Z_\mid \theta _)\,d\theta _.}
             
            
          
       
       
      Let 
           
            
             
              
              
               n
               
               
               
                j
                
               
                ,
                
               
                r
                
               
               
               
                i
                
               
              
             
            
           
            ^}
            
           
          be the number of word tokens in the 
           
            
             
              
              
               j
               
               
               
                t
                
               
                h
                
               
              
             
            
           
            }
            
           
          document with the same word symbol (the 
           
            
             
              
              
               r
               
               
               
                t
                
               
                h
                
               
              
             
            
           
            }
            
           
          word in the vocabulary) assigned to the 
           
            
             
              
              
               i
               
               
               
                t
                
               
                h
                
               
              
             
            
           
            }
            
           
          topic. So, 
           
            
             
              
              
               n
               
               
               
                j
                
               
                ,
                
               
                r
                
               
               
               
                i
                
               
              
             
            
           
            ^}
            
           
          is three dimensional. If any of the three dimensions is not limited to a specific value, we use a parenthesized point 
           
            
             
             
              (
              
             
              ⋅
              
             
              )
              
             
            
           
            
            
           
          to denote. For example, 
           
            
             
              
              
               n
               
               
               
                j
                
               
                ,
                
               
                (
                
               
                ⋅
                
               
                )
                
               
               
               
                i
                
               
              
             
            
           
            ^}
            
           
          denotes the number of word tokens in the 
           
            
             
              
              
               j
               
               
               
                t
                
               
                h
                
               
              
             
            
           
            }
            
           
          document assigned to the 
           
            
             
              
              
               i
               
               
               
                t
                
               
                h
                
               
              
             
            
           
            }
            
           
          topic. Thus, the right most part of the above equation can be rewritten as:  
      
       
        
            
             
              
               
               
                ∏
                
                
                
                 t
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 N
                 
                
               
              
               P
               
              
               (
               
               
               
                Z
                
                
                
                 j
                 
                
                 ,
                 
                
                 t
                 
                
               
              
               ∣
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               )
               
              
               =
               
               
               
                ∏
                
                
                
                 i
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 K
                 
                
               
               
               
                θ
                
                
                
                 j
                 
                
                 ,
                 
                
                 i
                 
                
                
                 
                 
                  n
                  
                  
                  
                   j
                   
                  
                   ,
                   
                  
                   (
                   
                  
                   ⋅
                   
                  
                   )
                   
                  
                  
                  
                   i
                   
                  
                 
                
               
              
               .
               
              
             
            
             ^P(Z_\mid \theta _)=\prod _^\theta _^^}.}
             
            
          
       
       
      So the 
           
            
             
              
              
               θ
               
               
               
                j
                
               
              
             
            
           
            }
            
           
          integration formula can be changed to:  
      
       
        
            
             
              
               
               
                ∫
                
                
                 
                 
                  θ
                  
                  
                  
                   j
                   
                  
                 
                
               
               
                
                 
                 
                  Γ
                  
                  
                  
                   (
                   
                   
                    
                    
                     ∑
                     
                     
                     
                      i
                      
                     
                      =
                      
                     
                      1
                      
                     
                     
                     
                      K
                      
                     
                    
                    
                    
                     α
                     
                     
                     
                      i
                      
                     
                    
                   
                  
                   )
                   
                  
                 
                 
                  
                  
                   ∏
                   
                   
                   
                    i
                    
                   
                    =
                    
                   
                    1
                    
                   
                   
                   
                    K
                    
                   
                  
                 
                  Γ
                  
                 
                  (
                  
                  
                  
                   α
                   
                   
                   
                    i
                    
                   
                  
                 
                  )
                  
                 
                
               
               
               
                ∏
                
                
                
                 i
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 K
                 
                
               
               
               
                θ
                
                
                
                 j
                 
                
                 ,
                 
                
                 i
                 
                
                
                 
                 
                  α
                  
                  
                  
                   i
                   
                  
                 
                
                 −
                 
                
                 1
                 
                
               
               
               
                ∏
                
                
                
                 i
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 K
                 
                
               
               
               
                θ
                
                
                
                 j
                 
                
                 ,
                 
                
                 i
                 
                
                
                 
                 
                  n
                  
                  
                  
                   j
                   
                  
                   ,
                   
                  
                   (
                   
                  
                   ⋅
                   
                  
                   )
                   
                  
                  
                  
                   i
                   
                  
                 
                
               
               
              
               d
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               =
               
               
               
                ∫
                
                
                 
                 
                  θ
                  
                  
                  
                   j
                   
                  
                 
                
               
               
                
                 
                 
                  Γ
                  
                  
                  
                   (
                   
                   
                    
                    
                     ∑
                     
                     
                     
                      i
                      
                     
                      =
                      
                     
                      1
                      
                     
                     
                     
                      K
                      
                     
                    
                    
                    
                     α
                     
                     
                     
                      i
                      
                     
                    
                   
                  
                   )
                   
                  
                 
                 
                  
                  
                   ∏
                   
                   
                   
                    i
                    
                   
                    =
                    
                   
                    1
                    
                   
                   
                   
                    K
                    
                   
                  
                 
                  Γ
                  
                 
                  (
                  
                  
                  
                   α
                   
                   
                   
                    i
                    
                   
                  
                 
                  )
                  
                 
                
               
               
               
                ∏
                
                
                
                 i
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 K
                 
                
               
               
               
                θ
                
                
                
                 j
                 
                
                 ,
                 
                
                 i
                 
                
                
                 
                 
                  n
                  
                  
                  
                   j
                   
                  
                   ,
                   
                  
                   (
                   
                  
                   ⋅
                   
                  
                   )
                   
                  
                  
                  
                   i
                   
                  
                 
                
                 +
                 
                 
                 
                  α
                  
                  
                  
                   i
                   
                  
                 
                
                 −
                 
                
                 1
                 
                
               
               
              
               d
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               .
               
              
             
            
             }^\alpha _\right)}^\Gamma (\alpha _)}}\prod _^\theta _^-1}\prod _^\theta _^^}\,d\theta _=\int _}^\alpha _\right)}^\Gamma (\alpha _)}}\prod _^\theta _^^+\alpha _-1}\,d\theta _.}
             
            
          
       
       
      Clearly, the equation inside the integration has the same form as the Dirichlet distribution. According to the Dirichlet distribution,  
      
       
        
            
             
              
               
               
                ∫
                
                
                 
                 
                  θ
                  
                  
                  
                   j
                   
                  
                 
                
               
               
                
                 
                 
                  Γ
                  
                  
                  
                   (
                   
                   
                    
                    
                     ∑
                     
                     
                     
                      i
                      
                     
                      =
                      
                     
                      1
                      
                     
                     
                     
                      K
                      
                     
                    
                    
                    
                     n
                     
                     
                     
                      j
                      
                     
                      ,
                      
                     
                      (
                      
                     
                      ⋅
                      
                     
                      )
                      
                     
                     
                     
                      i
                      
                     
                    
                   
                    +
                    
                    
                    
                     α
                     
                     
                     
                      i
                      
                     
                    
                   
                  
                   )
                   
                  
                 
                 
                  
                  
                   ∏
                   
                   
                   
                    i
                    
                   
                    =
                    
                   
                    1
                    
                   
                   
                   
                    K
                    
                   
                  
                 
                  Γ
                  
                 
                  (
                  
                  
                  
                   n
                   
                   
                   
                    j
                    
                   
                    ,
                    
                   
                    (
                    
                   
                    ⋅
                    
                   
                    )
                    
                   
                   
                   
                    i
                    
                   
                  
                 
                  +
                  
                  
                  
                   α
                   
                   
                   
                    i
                    
                   
                  
                 
                  )
                  
                 
                
               
               
               
                ∏
                
                
                
                 i
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 K
                 
                
               
               
               
                θ
                
                
                
                 j
                 
                
                 ,
                 
                
                 i
                 
                
                
                 
                 
                  n
                  
                  
                  
                   j
                   
                  
                   ,
                   
                  
                   (
                   
                  
                   ⋅
                   
                  
                   )
                   
                  
                  
                  
                   i
                   
                  
                 
                
                 +
                 
                 
                 
                  α
                  
                  
                  
                   i
                   
                  
                 
                
                 −
                 
                
                 1
                 
                
               
               
              
               d
               
               
               
                θ
                
                
                
                 j
                 
                
               
              
               =
               
              
               1.
               
              
             
            
             }^n_^+\alpha _\right)}^\Gamma (n_^+\alpha _)}}\prod _^\theta _^^+\alpha _-1}\,d\theta _=1.}
             
            
          
       
       
      Thus,  
      
       
        
            
             
              
               
                
                 
                  
                  
                   
                   
                   
                    ∫
                    
                    
                     
                     
                      θ
                      
                      
                      
                       j
                       
                      
                     
                    
                   
                  
                   P
                   
                  
                   (
                   
                   
                   
                    θ
                    
                    
                    
                     j
                     
                    
                   
                  
                   ;
                   
                  
                   α
                   
                  
                   )
                   
                   
                   
                    ∏
                    
                    
                    
                     t
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     N
                     
                    
                   
                  
                   P
                   
                  
                   (
                   
                   
                   
                    Z
                    
                    
                    
                     j
                     
                    
                     ,
                     
                    
                     t
                     
                    
                   
                  
                   ∣
                   
                   
                   
                    θ
                    
                    
                    
                     j
                     
                    
                   
                  
                   )
                   
                   
                  
                   d
                   
                   
                   
                    θ
                    
                    
                    
                     j
                     
                    
                   
                  
                   =
                   
                   
                   
                    ∫
                    
                    
                     
                     
                      θ
                      
                      
                      
                       j
                       
                      
                     
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          i
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          K
                          
                         
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                      
                      
                       ∏
                       
                       
                       
                        i
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        K
                        
                       
                      
                     
                      Γ
                      
                     
                      (
                      
                      
                      
                       α
                       
                       
                       
                        i
                        
                       
                      
                     
                      )
                      
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                   
                   
                    θ
                    
                    
                    
                     j
                     
                    
                     ,
                     
                    
                     i
                     
                    
                    
                     
                     
                      n
                      
                      
                      
                       j
                       
                      
                       ,
                       
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                      
                      
                       i
                       
                      
                     
                    
                     +
                     
                     
                     
                      α
                      
                      
                      
                       i
                       
                      
                     
                    
                     −
                     
                    
                     1
                     
                    
                   
                   
                  
                   d
                   
                   
                   
                    θ
                    
                    
                    
                     j
                     
                    
                   
                  
                 
                 
                  
                  
                   =
                   
                   
                   
                  
                  
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          i
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          K
                          
                         
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                      
                      
                       ∏
                       
                       
                       
                        i
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        K
                        
                       
                      
                     
                      Γ
                      
                     
                      (
                      
                      
                      
                       α
                       
                       
                       
                        i
                        
                       
                      
                     
                      )
                      
                     
                    
                   
                   
                    
                     
                      
                      
                       ∏
                       
                       
                       
                        i
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        K
                        
                       
                      
                     
                      Γ
                      
                     
                      (
                      
                      
                      
                       n
                       
                       
                       
                        j
                        
                       
                        ,
                        
                       
                        (
                        
                       
                        ⋅
                        
                       
                        )
                        
                       
                       
                       
                        i
                        
                       
                      
                     
                      +
                      
                      
                      
                       α
                       
                       
                       
                        i
                        
                       
                      
                     
                      )
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          i
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          K
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          j
                          
                         
                          ,
                          
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                   
                   
                    ∫
                    
                    
                     
                     
                      θ
                      
                      
                      
                       j
                       
                      
                     
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          i
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          K
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          j
                          
                         
                          ,
                          
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                      
                      
                       ∏
                       
                       
                       
                        i
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        K
                        
                       
                      
                     
                      Γ
                      
                     
                      (
                      
                      
                      
                       n
                       
                       
                       
                        j
                        
                       
                        ,
                        
                       
                        (
                        
                       
                        ⋅
                        
                       
                        )
                        
                       
                       
                       
                        i
                        
                       
                      
                     
                      +
                      
                      
                      
                       α
                       
                       
                       
                        i
                        
                       
                      
                     
                      )
                      
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                   
                   
                    θ
                    
                    
                    
                     j
                     
                    
                     ,
                     
                    
                     i
                     
                    
                    
                     
                     
                      n
                      
                      
                      
                       j
                       
                      
                       ,
                       
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                      
                      
                       i
                       
                      
                     
                    
                     +
                     
                     
                     
                      α
                      
                      
                      
                       i
                       
                      
                     
                    
                     −
                     
                    
                     1
                     
                    
                   
                   
                  
                   d
                   
                   
                   
                    θ
                    
                    
                    
                     j
                     
                    
                   
                  
                 
                 
                  
                  
                   =
                   
                   
                   
                  
                  
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          i
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          K
                          
                         
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                      
                      
                       ∏
                       
                       
                       
                        i
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        K
                        
                       
                      
                     
                      Γ
                      
                     
                      (
                      
                      
                      
                       α
                       
                       
                       
                        i
                        
                       
                      
                     
                      )
                      
                     
                    
                   
                   
                    
                     
                      
                      
                       ∏
                       
                       
                       
                        i
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        K
                        
                       
                      
                     
                      Γ
                      
                     
                      (
                      
                      
                      
                       n
                       
                       
                       
                        j
                        
                       
                        ,
                        
                       
                        (
                        
                       
                        ⋅
                        
                       
                        )
                        
                       
                       
                       
                        i
                        
                       
                      
                     
                      +
                      
                      
                      
                       α
                       
                       
                       
                        i
                        
                       
                      
                     
                      )
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          i
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          K
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          j
                          
                         
                          ,
                          
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                  
                   .
                   
                  
                 
                
               
              
             
            
             &amp;\int _}P(\theta _;\alpha )\prod _^P(Z_\mid \theta _)\,d\theta _=\int _}^\alpha _\right)}^\Gamma (\alpha _)}}\prod _^\theta _^^+\alpha _-1}\,d\theta _\\=&amp;^\alpha _\right)}^\Gamma (\alpha _)}}^\Gamma (n_^+\alpha _)}^n_^+\alpha _\right)}}\int _}^n_^+\alpha _\right)}^\Gamma (n_^+\alpha _)}}\prod _^\theta _^^+\alpha _-1}\,d\theta _\\=&amp;^\alpha _\right)}^\Gamma (\alpha _)}}^\Gamma (n_^+\alpha _)}^n_^+\alpha _\right)}}.\end}}
             
            
          
       
       
      Now we turn our attention to the 
           
            
             
              
              
               φ
               
              
             
            
           
            }}
            
           
          part. Actually, the derivation of the 
           
            
             
              
              
               φ
               
              
             
            
           
            }}
            
           
          part is very similar to the 
           
            
             
              
              
               θ
               
              
             
            
           
            }}
            
           
          part. Here we only list the steps of the derivation:  
      
       
        
            
             
              
               
                
                 
                  
                  
                   
                   
                   
                    ∫
                    
                    
                    
                     φ
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                  
                   P
                   
                  
                   (
                   
                   
                   
                    φ
                    
                    
                    
                     i
                     
                    
                   
                  
                   ;
                   
                  
                   β
                   
                  
                   )
                   
                   
                   
                    ∏
                    
                    
                    
                     j
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     M
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     t
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     N
                     
                    
                   
                  
                   P
                   
                  
                   (
                   
                   
                   
                    W
                    
                    
                    
                     j
                     
                    
                     ,
                     
                    
                     t
                     
                    
                   
                  
                   ∣
                   
                   
                   
                    φ
                    
                    
                     
                     
                      Z
                      
                      
                      
                       j
                       
                      
                       ,
                       
                      
                       t
                       
                      
                     
                    
                   
                  
                   )
                   
                   
                  
                   d
                   
                   
                   
                    φ
                    
                   
                  
                 
                 
                  
                  
                   =
                   
                   
                   
                  
                  
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                   
                   
                    ∫
                    
                    
                     
                     
                      φ
                      
                      
                      
                       i
                       
                      
                     
                    
                   
                  
                   P
                   
                  
                   (
                   
                   
                   
                    φ
                    
                    
                    
                     i
                     
                    
                   
                  
                   ;
                   
                  
                   β
                   
                  
                   )
                   
                   
                   
                    ∏
                    
                    
                    
                     j
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     M
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     t
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     N
                     
                    
                   
                  
                   P
                   
                  
                   (
                   
                   
                   
                    W
                    
                    
                    
                     j
                     
                    
                     ,
                     
                    
                     t
                     
                    
                   
                  
                   ∣
                   
                   
                   
                    φ
                    
                    
                     
                     
                      Z
                      
                      
                      
                       j
                       
                      
                       ,
                       
                      
                       t
                       
                      
                     
                    
                   
                  
                   )
                   
                   
                  
                   d
                   
                   
                   
                    φ
                    
                    
                    
                     i
                     
                    
                   
                  
                 
                 
                  
                  
                   =
                   
                   
                   
                  
                  
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                   
                   
                    ∫
                    
                    
                     
                     
                      φ
                      
                      
                      
                       i
                       
                      
                     
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                      
                      
                       ∏
                       
                       
                       
                        r
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        V
                        
                       
                      
                     
                      Γ
                      
                     
                      (
                      
                      
                      
                       β
                       
                       
                       
                        r
                        
                       
                      
                     
                      )
                      
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     r
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     V
                     
                    
                   
                   
                   
                    φ
                    
                    
                    
                     i
                     
                    
                     ,
                     
                    
                     r
                     
                    
                    
                     
                     
                      β
                      
                      
                      
                       r
                       
                      
                     
                    
                     −
                     
                    
                     1
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     r
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     V
                     
                    
                   
                   
                   
                    φ
                    
                    
                    
                     i
                     
                    
                     ,
                     
                    
                     r
                     
                    
                    
                     
                     
                      n
                      
                      
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                       ,
                       
                      
                       r
                       
                      
                      
                      
                       i
                       
                      
                     
                    
                   
                   
                  
                   d
                   
                   
                   
                    φ
                    
                    
                    
                     i
                     
                    
                   
                  
                 
                 
                  
                  
                   =
                   
                   
                   
                  
                  
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                   
                   
                    ∫
                    
                    
                     
                     
                      φ
                      
                      
                      
                       i
                       
                      
                     
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                      
                      
                       ∏
                       
                       
                       
                        r
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        V
                        
                       
                      
                     
                      Γ
                      
                     
                      (
                      
                      
                      
                       β
                       
                       
                       
                        r
                        
                       
                      
                     
                      )
                      
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     r
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     V
                     
                    
                   
                   
                   
                    φ
                    
                    
                    
                     i
                     
                    
                     ,
                     
                    
                     r
                     
                    
                    
                     
                     
                      n
                      
                      
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                       ,
                       
                      
                       r
                       
                      
                      
                      
                       i
                       
                      
                     
                    
                     +
                     
                     
                     
                      β
                      
                      
                      
                       r
                       
                      
                     
                    
                     −
                     
                    
                     1
                     
                    
                   
                   
                  
                   d
                   
                   
                   
                    φ
                    
                    
                    
                     i
                     
                    
                   
                  
                 
                 
                  
                  
                   =
                   
                   
                   
                  
                  
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                      
                      
                       ∏
                       
                       
                       
                        r
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        V
                        
                       
                      
                     
                      Γ
                      
                     
                      (
                      
                      
                      
                       β
                       
                       
                       
                        r
                        
                       
                      
                     
                      )
                      
                     
                    
                   
                   
                    
                     
                      
                      
                       ∏
                       
                       
                       
                        r
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        V
                        
                       
                      
                     
                      Γ
                      
                     
                      (
                      
                      
                      
                       n
                       
                       
                       
                        (
                        
                       
                        ⋅
                        
                       
                        )
                        
                       
                        ,
                        
                       
                        r
                        
                       
                       
                       
                        i
                        
                       
                      
                     
                      +
                      
                      
                      
                       β
                       
                       
                       
                        r
                        
                       
                      
                     
                      )
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          r
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                  
                   .
                   
                  
                 
                
               
              
             
            
             &amp;\int _}\prod _^P(\varphi _;\beta )\prod _^\prod _^P(W_\mid \varphi _})\,d}\\=&amp;\prod _^\int _}P(\varphi _;\beta )\prod _^\prod _^P(W_\mid \varphi _})\,d\varphi _\\=&amp;\prod _^\int _}^\beta _\right)}^\Gamma (\beta _)}}\prod _^\varphi _^-1}\prod _^\varphi _^^}\,d\varphi _\\=&amp;\prod _^\int _}^\beta _\right)}^\Gamma (\beta _)}}\prod _^\varphi _^^+\beta _-1}\,d\varphi _\\=&amp;\prod _^^\beta _\right)}^\Gamma (\beta _)}}^\Gamma (n_^+\beta _)}^n_^+\beta _\right)}}.\end}}
             
            
          
       
       
      For clarity, here we write down the final equation with both 
           
            
             
              
              
               ϕ
               
              
             
            
           
            }}
            
           
          and 
           
            
             
              
              
               θ
               
              
             
            
           
            }}
            
           
          integrated out:  
      
       
        
            
             
              
              
               P
               
              
               (
               
               
               
                Z
                
               
              
               ,
               
               
               
                W
                
               
              
               ;
               
              
               α
               
              
               ,
               
              
               β
               
              
               )
               
              
               =
               
               
               
                ∏
                
                
                
                 j
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 M
                 
                
               
               
                
                 
                 
                  Γ
                  
                  
                  
                   (
                   
                   
                    
                    
                     ∑
                     
                     
                     
                      i
                      
                     
                      =
                      
                     
                      1
                      
                     
                     
                     
                      K
                      
                     
                    
                    
                    
                     α
                     
                     
                     
                      i
                      
                     
                    
                   
                  
                   )
                   
                  
                 
                 
                  
                  
                   ∏
                   
                   
                   
                    i
                    
                   
                    =
                    
                   
                    1
                    
                   
                   
                   
                    K
                    
                   
                  
                 
                  Γ
                  
                 
                  (
                  
                  
                  
                   α
                   
                   
                   
                    i
                    
                   
                  
                 
                  )
                  
                 
                
               
               
                
                 
                  
                  
                   ∏
                   
                   
                   
                    i
                    
                   
                    =
                    
                   
                    1
                    
                   
                   
                   
                    K
                    
                   
                  
                 
                  Γ
                  
                 
                  (
                  
                  
                  
                   n
                   
                   
                   
                    j
                    
                   
                    ,
                    
                   
                    (
                    
                   
                    ⋅
                    
                   
                    )
                    
                   
                   
                   
                    i
                    
                   
                  
                 
                  +
                  
                  
                  
                   α
                   
                   
                   
                    i
                    
                   
                  
                 
                  )
                  
                 
                 
                 
                  Γ
                  
                  
                  
                   (
                   
                   
                    
                    
                     ∑
                     
                     
                     
                      i
                      
                     
                      =
                      
                     
                      1
                      
                     
                     
                     
                      K
                      
                     
                    
                    
                    
                     n
                     
                     
                     
                      j
                      
                     
                      ,
                      
                     
                      (
                      
                     
                      ⋅
                      
                     
                      )
                      
                     
                     
                     
                      i
                      
                     
                    
                   
                    +
                    
                    
                    
                     α
                     
                     
                     
                      i
                      
                     
                    
                   
                  
                   )
                   
                  
                 
                
               
              
               ×
               
               
               
                ∏
                
                
                
                 i
                 
                
                 =
                 
                
                 1
                 
                
                
                
                 K
                 
                
               
               
                
                 
                 
                  Γ
                  
                  
                  
                   (
                   
                   
                    
                    
                     ∑
                     
                     
                     
                      r
                      
                     
                      =
                      
                     
                      1
                      
                     
                     
                     
                      V
                      
                     
                    
                    
                    
                     β
                     
                     
                     
                      r
                      
                     
                    
                   
                  
                   )
                   
                  
                 
                 
                  
                  
                   ∏
                   
                   
                   
                    r
                    
                   
                    =
                    
                   
                    1
                    
                   
                   
                   
                    V
                    
                   
                  
                 
                  Γ
                  
                 
                  (
                  
                  
                  
                   β
                   
                   
                   
                    r
                    
                   
                  
                 
                  )
                  
                 
                
               
               
                
                 
                  
                  
                   ∏
                   
                   
                   
                    r
                    
                   
                    =
                    
                   
                    1
                    
                   
                   
                   
                    V
                    
                   
                  
                 
                  Γ
                  
                 
                  (
                  
                  
                  
                   n
                   
                   
                   
                    (
                    
                   
                    ⋅
                    
                   
                    )
                    
                   
                    ,
                    
                   
                    r
                    
                   
                   
                   
                    i
                    
                   
                  
                 
                  +
                  
                  
                  
                   β
                   
                   
                   
                    r
                    
                   
                  
                 
                  )
                  
                 
                 
                 
                  Γ
                  
                  
                  
                   (
                   
                   
                    
                    
                     ∑
                     
                     
                     
                      r
                      
                     
                      =
                      
                     
                      1
                      
                     
                     
                     
                      V
                      
                     
                    
                    
                    
                     n
                     
                     
                     
                      (
                      
                     
                      ⋅
                      
                     
                      )
                      
                     
                      ,
                      
                     
                      r
                      
                     
                     
                     
                      i
                      
                     
                    
                   
                    +
                    
                    
                    
                     β
                     
                     
                     
                      r
                      
                     
                    
                   
                  
                   )
                   
                  
                 
                
               
              
               .
               
              
             
            
             },};\alpha ,\beta )=\prod _^^\alpha _\right)}^\Gamma (\alpha _)}}^\Gamma (n_^+\alpha _)}^n_^+\alpha _\right)}}\times \prod _^^\beta _\right)}^\Gamma (\beta _)}}^\Gamma (n_^+\beta _)}^n_^+\beta _\right)}}.}
             
            
          
       
       
      The goal of Gibbs Sampling here is to approximate the distribution of 
           
            
             
             
              P
              
             
              (
              
              
              
               Z
               
              
             
              ∣
              
              
              
               W
               
              
             
              ;
              
             
              α
              
             
              ,
              
             
              β
              
             
              )
              
             
            
           
            }\mid };\alpha ,\beta )}
            
           
         . Since 
           
            
             
             
              P
              
             
              (
              
              
              
               W
               
              
             
              ;
              
             
              α
              
             
              ,
              
             
              β
              
             
              )
              
             
            
           
            };\alpha ,\beta )}
            
           
          is invariable for any of Z, Gibbs Sampling equations can be derived from 
           
            
             
             
              P
              
             
              (
              
              
              
               Z
               
              
             
              ,
              
              
              
               W
               
              
             
              ;
              
             
              α
              
             
              ,
              
             
              β
              
             
              )
              
             
            
           
            },};\alpha ,\beta )}
            
           
          directly. The key point is to derive the following conditional probability:  
      
       
        
            
             
              
              
               P
               
              
               (
               
               
               
                Z
                
                
                
                 (
                 
                
                 m
                 
                
                 ,
                 
                
                 n
                 
                
                 )
                 
                
               
              
               ∣
               
               
                
                
                 Z
                 
                 
                 
                  −
                  
                 
                  (
                  
                 
                  m
                  
                 
                  ,
                  
                 
                  n
                  
                 
                  )
                  
                 
                
               
              
               ,
               
               
               
                W
                
               
              
               ;
               
              
               α
               
              
               ,
               
              
               β
               
              
               )
               
              
               =
               
               
                
                 
                 
                  P
                  
                 
                  (
                  
                  
                  
                   Z
                   
                   
                   
                    (
                    
                   
                    m
                    
                   
                    ,
                    
                   
                    n
                    
                   
                    )
                    
                   
                  
                 
                  ,
                  
                  
                   
                   
                    Z
                    
                    
                    
                     −
                     
                    
                     (
                     
                    
                     m
                     
                    
                     ,
                     
                    
                     n
                     
                    
                     )
                     
                    
                   
                  
                 
                  ,
                  
                  
                  
                   W
                   
                  
                 
                  ;
                  
                 
                  α
                  
                 
                  ,
                  
                 
                  β
                  
                 
                  )
                  
                 
                 
                 
                  P
                  
                 
                  (
                  
                  
                   
                   
                    Z
                    
                    
                    
                     −
                     
                    
                     (
                     
                    
                     m
                     
                    
                     ,
                     
                    
                     n
                     
                    
                     )
                     
                    
                   
                  
                 
                  ,
                  
                  
                  
                   W
                   
                  
                 
                  ;
                  
                 
                  α
                  
                 
                  ,
                  
                 
                  β
                  
                 
                  )
                  
                 
                
               
              
               ,
               
              
             
            
             \mid }},};\alpha ,\beta )=,}},};\alpha ,\beta )}}},};\alpha ,\beta )}},}
             
            
          
       
       
      where 
           
            
             
              
              
               Z
               
               
               
                (
                
               
                m
                
               
                ,
                
               
                n
                
               
                )
                
               
              
             
            
           
            }
            
           
          denotes the 
           
            
             
             
              Z
              
             
            
           
            
            
           
          hidden variable of the 
           
            
             
              
              
               n
               
               
               
                t
                
               
                h
                
               
              
             
            
           
            }
            
           
          word token in the 
           
            
             
              
              
               m
               
               
               
                t
                
               
                h
                
               
              
             
            
           
            }
            
           
          document. And further we assume that the word symbol of it is the 
           
            
             
              
              
               v
               
               
               
                t
                
               
                h
                
               
              
             
            
           
            }
            
           
          word in the vocabulary. 
           
            
             
              
               
               
                Z
                
                
                
                 −
                 
                
                 (
                 
                
                 m
                 
                
                 ,
                 
                
                 n
                 
                
                 )
                 
                
               
              
             
            
           
            }}}
            
           
          denotes all the 
           
            
             
             
              Z
              
             
            
           
            
            
           
         s but 
           
            
             
              
              
               Z
               
               
               
                (
                
               
                m
                
               
                ,
                
               
                n
                
               
                )
                
               
              
             
            
           
            }
            
           
         . Note that Gibbs Sampling needs only to sample a value for 
           
            
             
              
              
               Z
               
               
               
                (
                
               
                m
                
               
                ,
                
               
                n
                
               
                )
                
               
              
             
            
           
            }
            
           
         , according to the above probability, we do not need the exact value of  
      
       
        
            
             
              
              
               P
               
               
               
                (
                
                
                 
                 
                  Z
                  
                  
                  
                   m
                   
                  
                   ,
                   
                  
                   n
                   
                  
                 
                
                 ∣
                 
                 
                  
                  
                   Z
                   
                   
                   
                    −
                    
                   
                    (
                    
                   
                    m
                    
                   
                    ,
                    
                   
                    n
                    
                   
                    )
                    
                   
                  
                 
                
                 ,
                 
                 
                 
                  W
                  
                 
                
                 ;
                 
                
                 α
                 
                
                 ,
                 
                
                 β
                 
                
               
                )
                
               
              
             
            
             \mid }},};\alpha ,\beta \right)}
             
            
          
       
       
      but the ratios among the probabilities that 
           
            
             
              
              
               Z
               
               
               
                (
                
               
                m
                
               
                ,
                
               
                n
                
               
                )
                
               
              
             
            
           
            }
            
           
          can take value. So, the above equation can be simplified as:  
      
       
        
            
             
              
               
                
                 
                  
                  
                   P
                   
                  
                   (
                   
                  
                  
                   
                   
                    Z
                    
                    
                    
                     (
                     
                    
                     m
                     
                    
                     ,
                     
                    
                     n
                     
                    
                     )
                     
                    
                   
                  
                   =
                   
                  
                   v
                   
                  
                   ∣
                   
                   
                    
                    
                     Z
                     
                     
                     
                      −
                      
                     
                      (
                      
                     
                      m
                      
                     
                      ,
                      
                     
                      n
                      
                     
                      )
                      
                     
                    
                   
                  
                   ,
                   
                   
                   
                    W
                    
                   
                  
                   ;
                   
                  
                   α
                   
                  
                   ,
                   
                  
                   β
                   
                  
                   )
                   
                  
                 
                 
                  
                  
                   
                  
                   ∝
                   
                  
                   P
                   
                  
                   (
                   
                   
                   
                    Z
                    
                    
                    
                     (
                     
                    
                     m
                     
                    
                     ,
                     
                    
                     n
                     
                    
                     )
                     
                    
                   
                  
                   =
                   
                  
                   v
                   
                  
                   ,
                   
                   
                    
                    
                     Z
                     
                     
                     
                      −
                      
                     
                      (
                      
                     
                      m
                      
                     
                      ,
                      
                     
                      n
                      
                     
                      )
                      
                     
                    
                   
                  
                   ,
                   
                   
                   
                    W
                    
                   
                  
                   ;
                   
                  
                   α
                   
                  
                   ,
                   
                  
                   β
                   
                  
                   )
                   
                  
                 
                 
                  
                  
                   
                  
                   =
                   
                   
                    
                    
                     (
                     
                     
                      
                       
                       
                        Γ
                        
                        
                        
                         (
                         
                         
                          
                          
                           ∑
                           
                           
                           
                            i
                            
                           
                            =
                            
                           
                            1
                            
                           
                           
                           
                            K
                            
                           
                          
                          
                          
                           α
                           
                           
                           
                            i
                            
                           
                          
                         
                        
                         )
                         
                        
                       
                       
                        
                        
                         ∏
                         
                         
                         
                          i
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          K
                          
                         
                        
                       
                        Γ
                        
                       
                        (
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                        )
                        
                       
                      
                     
                    
                     )
                     
                    
                    
                    
                     M
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     j
                     
                    
                     ≠
                     
                    
                     m
                     
                    
                   
                   
                    
                     
                      
                      
                       ∏
                       
                       
                       
                        i
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        K
                        
                       
                      
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         n
                         
                         
                         
                          j
                          
                         
                          ,
                          
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          i
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          K
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          j
                          
                         
                          ,
                          
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                   
                    
                    
                     (
                     
                     
                      
                       
                       
                        Γ
                        
                        
                        
                         (
                         
                         
                          
                          
                           ∑
                           
                           
                           
                            r
                            
                           
                            =
                            
                           
                            1
                            
                           
                           
                           
                            V
                            
                           
                          
                          
                          
                           β
                           
                           
                           
                            r
                            
                           
                          
                         
                        
                         )
                         
                        
                       
                       
                        
                        
                         ∏
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                       
                        Γ
                        
                       
                        (
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                        )
                        
                       
                      
                     
                    
                     )
                     
                    
                    
                    
                     K
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     r
                     
                    
                     ≠
                     
                    
                     v
                     
                    
                   
                  
                   Γ
                   
                   
                   
                    (
                    
                    
                     
                     
                      n
                      
                      
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                       ,
                       
                      
                       r
                       
                      
                      
                      
                       i
                       
                      
                     
                    
                     +
                     
                     
                     
                      β
                      
                      
                      
                       r
                       
                      
                     
                    
                   
                    )
                    
                   
                   
                    
                     
                      
                      
                       ∏
                       
                       
                       
                        i
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        K
                        
                       
                      
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         n
                         
                         
                         
                          m
                          
                         
                          ,
                          
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          i
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          K
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          m
                          
                         
                          ,
                          
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          v
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          v
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          r
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                  
                 
                 
                  
                  
                   
                  
                   ∝
                   
                   
                    
                     
                      
                      
                       ∏
                       
                       
                       
                        i
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        K
                        
                       
                      
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         n
                         
                         
                         
                          m
                          
                         
                          ,
                          
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          i
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          K
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          m
                          
                         
                          ,
                          
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         α
                         
                         
                         
                          i
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          v
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          v
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          r
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                  
                 
                 
                  
                  
                   
                  
                   ∝
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                  
                   Γ
                   
                   
                   
                    (
                    
                    
                     
                     
                      n
                      
                      
                      
                       m
                       
                      
                       ,
                       
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                      
                      
                       i
                       
                      
                     
                    
                     +
                     
                     
                     
                      α
                      
                      
                      
                       i
                       
                      
                     
                    
                   
                    )
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     =
                     
                    
                     1
                     
                    
                    
                    
                     K
                     
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          v
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          v
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          r
                          
                         
                         
                         
                          i
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                  
                   .
                   
                  
                 
                
               
              
             
            
             P(&amp;Z_=v\mid }},};\alpha ,\beta )\\&amp;\propto P(Z_=v,}},};\alpha ,\beta )\\&amp;=\left(^\alpha _\right)}^\Gamma (\alpha _)}}\right)^\prod _^\Gamma \left(n_^+\alpha _\right)}^n_^+\alpha _\right)}}\left(^\beta _\right)}^\Gamma (\beta _)}}\right)^\prod _^\prod _\Gamma \left(n_^+\beta _\right)^\Gamma \left(n_^+\alpha _\right)}^n_^+\alpha _\right)}}\prod _^^+\beta _\right)}^n_^+\beta _\right)}}\\&amp;\propto ^\Gamma \left(n_^+\alpha _\right)}^n_^+\alpha _\right)}}\prod _^^+\beta _\right)}^n_^+\beta _\right)}}\\&amp;\propto \prod _^\Gamma \left(n_^+\alpha _\right)\prod _^^+\beta _\right)}^n_^+\beta _\right)}}.\end}}
             
            
          
       
       
      Finally, let 
           
            
             
              
              
               n
               
               
               
                j
                
               
                ,
                
               
                r
                
               
               
               
                i
                
               
                ,
                
               
                −
                
               
                (
                
               
                m
                
               
                ,
                
               
                n
                
               
                )
                
               
              
             
            
           
            ^}
            
           
          be the same meaning as 
           
            
             
              
              
               n
               
               
               
                j
                
               
                ,
                
               
                r
                
               
               
               
                i
                
               
              
             
            
           
            ^}
            
           
          but with the 
           
            
             
              
              
               Z
               
               
               
                (
                
               
                m
                
               
                ,
                
               
                n
                
               
                )
                
               
              
             
            
           
            }
            
           
          excluded. The above equation can be further simplified leveraging the property of gamma function. We first split the summation and then merge it back to obtain a 
           
            
             
             
              k
              
             
            
           
            
            
           
         -independent summation, which could be dropped:  
      
       
        
            
             
              
               
                
                 
                  
                  
                   
                  
                   ∝
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     ≠
                     
                    
                     k
                     
                    
                   
                  
                   Γ
                   
                   
                   
                    (
                    
                    
                     
                     
                      n
                      
                      
                      
                       m
                       
                      
                       ,
                       
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                      
                      
                       i
                       
                      
                       ,
                       
                      
                       −
                       
                      
                       (
                       
                      
                       m
                       
                      
                       ,
                       
                      
                       n
                       
                      
                       )
                       
                      
                     
                    
                     +
                     
                     
                     
                      α
                      
                      
                      
                       i
                       
                      
                     
                    
                   
                    )
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     ≠
                     
                    
                     k
                     
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          v
                          
                         
                         
                         
                          i
                          
                         
                          ,
                          
                         
                          −
                          
                         
                          (
                          
                         
                          m
                          
                         
                          ,
                          
                         
                          n
                          
                         
                          )
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          v
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          r
                          
                         
                         
                         
                          i
                          
                         
                          ,
                          
                         
                          −
                          
                         
                          (
                          
                         
                          m
                          
                         
                          ,
                          
                         
                          n
                          
                         
                          )
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                  
                   Γ
                   
                   
                   
                    (
                    
                    
                     
                     
                      n
                      
                      
                      
                       m
                       
                      
                       ,
                       
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                      
                      
                       k
                       
                      
                       ,
                       
                      
                       −
                       
                      
                       (
                       
                      
                       m
                       
                      
                       ,
                       
                      
                       n
                       
                      
                       )
                       
                      
                     
                    
                     +
                     
                     
                     
                      α
                      
                      
                      
                       k
                       
                      
                     
                    
                     +
                     
                    
                     1
                     
                    
                   
                    )
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          v
                          
                         
                         
                         
                          k
                          
                         
                          ,
                          
                         
                          −
                          
                         
                          (
                          
                         
                          m
                          
                         
                          ,
                          
                         
                          n
                          
                         
                          )
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          v
                          
                         
                        
                       
                        +
                        
                       
                        1
                        
                       
                      
                       )
                       
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          r
                          
                         
                         
                         
                          k
                          
                         
                          ,
                          
                         
                          −
                          
                         
                          (
                          
                         
                          m
                          
                         
                          ,
                          
                         
                          n
                          
                         
                          )
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                        +
                        
                       
                        1
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                  
                 
                 
                  
                  
                   
                  
                   =
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     ≠
                     
                    
                     k
                     
                    
                   
                  
                   Γ
                   
                   
                   
                    (
                    
                    
                     
                     
                      n
                      
                      
                      
                       m
                       
                      
                       ,
                       
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                      
                      
                       i
                       
                      
                       ,
                       
                      
                       −
                       
                      
                       (
                       
                      
                       m
                       
                      
                       ,
                       
                      
                       n
                       
                      
                       )
                       
                      
                     
                    
                     +
                     
                     
                     
                      α
                      
                      
                      
                       i
                       
                      
                     
                    
                   
                    )
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                     ≠
                     
                    
                     k
                     
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          v
                          
                         
                         
                         
                          i
                          
                         
                          ,
                          
                         
                          −
                          
                         
                          (
                          
                         
                          m
                          
                         
                          ,
                          
                         
                          n
                          
                         
                          )
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          v
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          r
                          
                         
                         
                         
                          i
                          
                         
                          ,
                          
                         
                          −
                          
                         
                          (
                          
                         
                          m
                          
                         
                          ,
                          
                         
                          n
                          
                         
                          )
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                  
                   Γ
                   
                   
                   
                    (
                    
                    
                     
                     
                      n
                      
                      
                      
                       m
                       
                      
                       ,
                       
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                      
                      
                       k
                       
                      
                       ,
                       
                      
                       −
                       
                      
                       (
                       
                      
                       m
                       
                      
                       ,
                       
                      
                       n
                       
                      
                       )
                       
                      
                     
                    
                     +
                     
                     
                     
                      α
                      
                      
                      
                       k
                       
                      
                     
                    
                   
                    )
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          v
                          
                         
                         
                         
                          k
                          
                         
                          ,
                          
                         
                          −
                          
                         
                          (
                          
                         
                          m
                          
                         
                          ,
                          
                         
                          n
                          
                         
                          )
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          v
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          r
                          
                         
                         
                         
                          k
                          
                         
                          ,
                          
                         
                          −
                          
                         
                          (
                          
                         
                          m
                          
                         
                          ,
                          
                         
                          n
                          
                         
                          )
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                   
                   
                    (
                    
                    
                     
                     
                      n
                      
                      
                      
                       m
                       
                      
                       ,
                       
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                      
                      
                       k
                       
                      
                       ,
                       
                      
                       −
                       
                      
                       (
                       
                      
                       m
                       
                      
                       ,
                       
                      
                       n
                       
                      
                       )
                       
                      
                     
                    
                     +
                     
                     
                     
                      α
                      
                      
                      
                       k
                       
                      
                     
                    
                   
                    )
                    
                   
                   
                    
                     
                      
                      
                       n
                       
                       
                       
                        (
                        
                       
                        ⋅
                        
                       
                        )
                        
                       
                        ,
                        
                       
                        v
                        
                       
                       
                       
                        k
                        
                       
                        ,
                        
                       
                        −
                        
                       
                        (
                        
                       
                        m
                        
                       
                        ,
                        
                       
                        n
                        
                       
                        )
                        
                       
                      
                     
                      +
                      
                      
                      
                       β
                       
                       
                       
                        v
                        
                       
                      
                     
                     
                      
                      
                       ∑
                       
                       
                       
                        r
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        V
                        
                       
                      
                      
                      
                       n
                       
                       
                       
                        (
                        
                       
                        ⋅
                        
                       
                        )
                        
                       
                        ,
                        
                       
                        r
                        
                       
                       
                       
                        k
                        
                       
                        ,
                        
                       
                        −
                        
                       
                        (
                        
                       
                        m
                        
                       
                        ,
                        
                       
                        n
                        
                       
                        )
                        
                       
                      
                     
                      +
                      
                      
                      
                       β
                       
                       
                       
                        r
                        
                       
                      
                     
                    
                   
                  
                 
                 
                  
                  
                   
                  
                   =
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                   
                  
                   Γ
                   
                   
                   
                    (
                    
                    
                     
                     
                      n
                      
                      
                      
                       m
                       
                      
                       ,
                       
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                      
                      
                       i
                       
                      
                       ,
                       
                      
                       −
                       
                      
                       (
                       
                      
                       m
                       
                      
                       ,
                       
                      
                       n
                       
                      
                       )
                       
                      
                     
                    
                     +
                     
                     
                     
                      α
                      
                      
                      
                       i
                       
                      
                     
                    
                   
                    )
                    
                   
                   
                   
                    ∏
                    
                    
                    
                     i
                     
                    
                   
                   
                    
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          v
                          
                         
                         
                         
                          i
                          
                         
                          ,
                          
                         
                          −
                          
                         
                          (
                          
                         
                          m
                          
                         
                          ,
                          
                         
                          n
                          
                         
                          )
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          v
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                     
                     
                      Γ
                      
                      
                      
                       (
                       
                       
                        
                        
                         ∑
                         
                         
                         
                          r
                          
                         
                          =
                          
                         
                          1
                          
                         
                         
                         
                          V
                          
                         
                        
                        
                        
                         n
                         
                         
                         
                          (
                          
                         
                          ⋅
                          
                         
                          )
                          
                         
                          ,
                          
                         
                          r
                          
                         
                         
                         
                          i
                          
                         
                          ,
                          
                         
                          −
                          
                         
                          (
                          
                         
                          m
                          
                         
                          ,
                          
                         
                          n
                          
                         
                          )
                          
                         
                        
                       
                        +
                        
                        
                        
                         β
                         
                         
                         
                          r
                          
                         
                        
                       
                      
                       )
                       
                      
                     
                    
                   
                   
                   
                    (
                    
                    
                     
                     
                      n
                      
                      
                      
                       m
                       
                      
                       ,
                       
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                      
                      
                       k
                       
                      
                       ,
                       
                      
                       −
                       
                      
                       (
                       
                      
                       m
                       
                      
                       ,
                       
                      
                       n
                       
                      
                       )
                       
                      
                     
                    
                     +
                     
                     
                     
                      α
                      
                      
                      
                       k
                       
                      
                     
                    
                   
                    )
                    
                   
                   
                    
                     
                      
                      
                       n
                       
                       
                       
                        (
                        
                       
                        ⋅
                        
                       
                        )
                        
                       
                        ,
                        
                       
                        v
                        
                       
                       
                       
                        k
                        
                       
                        ,
                        
                       
                        −
                        
                       
                        (
                        
                       
                        m
                        
                       
                        ,
                        
                       
                        n
                        
                       
                        )
                        
                       
                      
                     
                      +
                      
                      
                      
                       β
                       
                       
                       
                        v
                        
                       
                      
                     
                     
                      
                      
                       ∑
                       
                       
                       
                        r
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        V
                        
                       
                      
                      
                      
                       n
                       
                       
                       
                        (
                        
                       
                        ⋅
                        
                       
                        )
                        
                       
                        ,
                        
                       
                        r
                        
                       
                       
                       
                        k
                        
                       
                        ,
                        
                       
                        −
                        
                       
                        (
                        
                       
                        m
                        
                       
                        ,
                        
                       
                        n
                        
                       
                        )
                        
                       
                      
                     
                      +
                      
                      
                      
                       β
                       
                       
                       
                        r
                        
                       
                      
                     
                    
                   
                  
                 
                 
                  
                  
                   
                  
                   ∝
                   
                   
                   
                    (
                    
                    
                     
                     
                      n
                      
                      
                      
                       m
                       
                      
                       ,
                       
                      
                       (
                       
                      
                       ⋅
                       
                      
                       )
                       
                      
                      
                      
                       k
                       
                      
                       ,
                       
                      
                       −
                       
                      
                       (
                       
                      
                       m
                       
                      
                       ,
                       
                      
                       n
                       
                      
                       )
                       
                      
                     
                    
                     +
                     
                     
                     
                      α
                      
                      
                      
                       k
                       
                      
                     
                    
                   
                    )
                    
                   
                   
                    
                     
                      
                      
                       n
                       
                       
                       
                        (
                        
                       
                        ⋅
                        
                       
                        )
                        
                       
                        ,
                        
                       
                        v
                        
                       
                       
                       
                        k
                        
                       
                        ,
                        
                       
                        −
                        
                       
                        (
                        
                       
                        m
                        
                       
                        ,
                        
                       
                        n
                        
                       
                        )
                        
                       
                      
                     
                      +
                      
                      
                      
                       β
                       
                       
                       
                        v
                        
                       
                      
                     
                     
                      
                      
                       ∑
                       
                       
                       
                        r
                        
                       
                        =
                        
                       
                        1
                        
                       
                       
                       
                        V
                        
                       
                      
                      
                      
                       n
                       
                       
                       
                        (
                        
                       
                        ⋅
                        
                       
                        )
                        
                       
                        ,
                        
                       
                        r
                        
                       
                       
                       
                        k
                        
                       
                        ,
                        
                       
                        −
                        
                       
                        (
                        
                       
                        m
                        
                       
                        ,
                        
                       
                        n
                        
                       
                        )
                        
                       
                      
                     
                      +
                      
                      
                      
                       β
                       
                       
                       
                        r
                        
                       
                      
                     
                    
                   
                  
                 
                
               
              
             
            
             &amp;\propto \prod _\Gamma \left(n_^+\alpha _\right)\prod _^+\beta _\right)}^n_^+\beta _\right)}}\Gamma \left(n_^+\alpha _+1\right)^+\beta _+1\right)}^n_^+\beta _+1\right)}}\\&amp;=\prod _\Gamma \left(n_^+\alpha _\right)\prod _^+\beta _\right)}^n_^+\beta _\right)}}\Gamma \left(n_^+\alpha _\right)^+\beta _\right)}^n_^+\beta _\right)}}\left(n_^+\alpha _\right)^+\beta _}^n_^+\beta _}}\\&amp;=\prod _\Gamma \left(n_^+\alpha _\right)\prod _^+\beta _\right)}^n_^+\beta _\right)}}\left(n_^+\alpha _\right)^+\beta _}^n_^+\beta _}}\\&amp;\propto \left(n_^+\alpha _\right)^+\beta _}^n_^+\beta _}}\end}}
             
            
          
       
       
      Note that the same formula is derived in the article on the Dirichlet-multinomial distribution, as part of a more general discussion of integrating Dirichlet distribution priors out of a Bayesian network.  
      Related problems 
      Related models 
      Topic modeling is a classic solution to the problem of information retrieval using linked data and semantic web technology. Related models and techniques are, among others, latent semantic indexing, independent component analysis, probabilistic latent semantic indexing, non-negative matrix factorization, and Gamma-Poisson distribution. 
      The LDA model is highly modular and can therefore be easily extended. The main field of interest is modeling relations between topics. This is achieved by using another distribution on the simplex instead of the Dirichlet. The Correlated Topic Model follows this approach, inducing a correlation structure between topics by using the logistic normal distribution instead of the Dirichlet. Another extension is the hierarchical LDA (hLDA), where topics are joined together in a hierarchy by using the nested Chinese restaurant process, whose structure is learnt from data. LDA can also be extended to a corpus in which a document includes two types of information (e.g., words and names), as in the LDA-dual model. Nonparametric extensions of LDA include the hierarchical Dirichlet process mixture model, which allows the number of topics to be unbounded and learnt from data. 
      As noted earlier, pLSA is similar to LDA. The LDA model is essentially the Bayesian version of pLSA model. The Bayesian formulation tends to perform better on small datasets because Bayesian methods can avoid overfitting the data. For very large datasets, the results of the two models tend to converge. One difference is that pLSA uses a variable 
           
            
             
             
              d
              
             
            
           
            
            
           
          to represent a document in the training set. So in pLSA, when presented with a document the model hasn't seen before, we fix 
           
            
             
             
              Pr
              
             
              (
              
             
              w
              
             
              ∣
              
             
              z
              
             
              )
              
             
            
           
            
            
           
         —the probability of words under topics—to be that learned from the training set and use the same EM algorithm to infer 
           
            
             
             
              Pr
              
             
              (
              
             
              z
              
             
              ∣
              
             
              d
              
             
              )
              
             
            
           
            
            
           
         —the topic distribution under 
           
            
             
             
              d
              
             
            
           
            
            
           
         . Blei argues that this step is cheating because you are essentially refitting the model to the new data.  
      Spatial models 
      In evolutionary biology, it is often natural to assume that the geographic locations of the individuals observed bring some information about their ancestry. This is the rational of various models for geo-referenced genetic data. 
      Variations on LDA have been used to automatically put natural images into categories, such as "bedroom" or "forest", by treating an image as a document, and small patches of the image as words; one of the variations is called spatial latent Dirichlet allocation.  
      See also 
      
       Variational Bayesian methods 
       Pachinko allocation 
       tf-idf 
       Infer.NET
       
      References 
      
       
       
         
         ^ a b Pritchard, J. K.; Stephens, M.; Donnelly, P. (June 2000). "Inference of population structure using multilocus genotype data". Genetics. 155 (2): pp. 945–959. doi:10.1093/genetics/155.2.945. ISSN&nbsp;0016-6731. PMC&nbsp;1461096. PMID&nbsp;10835412.  
         ^ 
           Falush, D.; Stephens, M.; Pritchard, J. K. (2003). "Inference of population structure using multilocus genotype data: linked loci and correlated allele frequencies". Genetics. 164 (4): pp. 1567–1587. doi:10.1093/genetics/164.4.1567. PMC&nbsp;1462648. PMID&nbsp;12930761.  
         ^ a b c 
           Blei, David M.; Ng, Andrew Y.; Jordan, Michael I (January 2003). Lafferty, John (ed.). "Latent Dirichlet Allocation". Journal of Machine Learning Research. 3 (4–5): pp. 993–1022. doi:10.1162/jmlr.2003.3.4-5.993. Archived from the original on 2012-05-01. Retrieved 2006-12-19.  
         ^ 
           Girolami, Mark; Kaban, A. (2003). On an Equivalence between PLSI and LDA. Proceedings of SIGIR 2003. New York: Association for Computing Machinery. ISBN&nbsp;1-58113-646-3.  
         ^ 
           Griffiths, Thomas L.; Steyvers, Mark (April 6, 2004). "Finding scientific topics". Proceedings of the National Academy of Sciences. 101 (Suppl. 1): 5228–5235. Bibcode:2004PNAS..101.5228G. doi:10.1073/pnas.0307752101. PMC&nbsp;387300. PMID&nbsp;14872004.  
         ^ 
           Alexander, David H.; Novembre, John; Lange, Kenneth (2009). "Fast model-based estimation of ancestry in unrelated individuals". Genome Research. 19 (9): 1655–1664. doi:10.1101/gr.094052.109. PMC&nbsp;2752134. PMID&nbsp;19648217.  
         ^ a b 
           Guillot, G.; Estoup, A.; Mortier, F.; Cosson, J. (2005). "A spatial statistical model for landscape genetics". Genetics. 170 (3): pp. 1261–1280. doi:10.1534/genetics.104.033803. PMC&nbsp;1451194. PMID&nbsp;15520263.  
         ^ 
           Minka, Thomas; Lafferty, John (2002). Expectation-propagation for the generative aspect model (PDF). Proceedings of the 18th Conference on Uncertainty in Artificial Intelligence. San Francisco, CA: Morgan Kaufmann. ISBN&nbsp;1-55860-897-4.  
         ^ 
           Yao, Limin; Mimno, David; McCallum, Andrew (2009). Efficient methods for topic model inference on streaming document collections. 15th ACM SIGKDD international conference on Knowledge discovery and data mining.  
         ^ 
           Lamba, Manika; Madhusudhan, Margam (2019). "Mapping of topics in DESIDOC Journal of Library and Information Technology, India: a study". Scientometrics. 120 (2): 477–505. doi:10.1007/s11192-019-03137-5. S2CID&nbsp;174802673.  
         ^ 
           Blei, David M.; Lafferty, John D. (2006). "Correlated topic models" (PDF). Advances in Neural Information Processing Systems. 18.  
         ^ 
           Blei, David M.; Jordan, Michael I.; Griffiths, Thomas L.; Tenenbaum, Joshua B (2004). Hierarchical Topic Models and the Nested Chinese Restaurant Process (PDF). Advances in Neural Information Processing Systems 16: Proceedings of the 2003 Conference. MIT Press. ISBN&nbsp;0-262-20152-6.  
         ^ 
           Shu, Liangcai; Long, Bo; Meng, Weiyi (2009). A Latent Topic Model for Complete Entity Resolution (PDF). 25th IEEE International Conference on Data Engineering (ICDE 2009).  
         ^ 
           Guillot, G.; Leblois, R.; Coulon, A.; Frantz, A. (2009). "Statistical methods in spatial genetics". Molecular Ecology. 18 (23): pp. 4734–4756. doi:10.1111/j.1365-294X.2009.04410.x. PMID&nbsp;19878454.  
         ^ 
           Li, Fei-Fei; Perona, Pietro. "A Bayesian Hierarchical Model for Learning Natural Scene Categories". Proceedings of the 2005 IEEE Computer Society Conference on Computer Vision and Pattern Recognition (CVPR'05). 2: 524–531.  
         ^ 
           Wang, Xiaogang; Grimson, Eric (2007). "Spatial Latent Dirichlet Allocation" (PDF). Proceedings of Neural Information Processing Systems Conference (NIPS).  
        
       
       
      External links 
      
       
        
         
          
           
          
         
          
           This article's use of external links may not follow Wikipedia's policies or guidelines. Please improve this article by removing excessive or inappropriate external links, and converting useful links where appropriate into footnote references. (June 2016) (Learn how and when to remove this template message)
          
        
       
       
      
       jLDADMM A Java package for topic modeling on normal or short texts. jLDADMM includes implementations of the LDA topic model and the one-topic-per-document Dirichlet Multinomial Mixture model. jLDADMM also provides an implementation for document clustering evaluation to compare topic models. 
       STTM A Java package for short text topic modeling (https://github.com/qiang2100/STTM). STTM includes these following algorithms: Dirichlet Multinomial Mixture (DMM) in conference KDD2014, Biterm Topic Model (BTM) in journal TKDE2016, Word Network Topic Model (WNTM ) in journal KAIS2018, Pseudo-Document-Based Topic Model (PTM) in conference KDD2016, Self-Aggregation-Based Topic Model (SATM) in conference IJCAI2015, (ETM) in conference PAKDD2017, Generalized P´olya Urn (GPU) based Dirichlet Multinomial Mixturemodel (GPU-DMM) in conference SIGIR2016, Generalized P´olya Urn (GPU) based Poisson-based Dirichlet Multinomial Mixturemodel (GPU-PDMM) in journal TIS2017 and Latent Feature Model with DMM (LF-DMM) in journal TACL2015. STTM also includes six short text corpus for evaluation. STTM presents three aspects about how to evaluate the performance of the algorithms (i.e., topic coherence, clustering, and classification). 
       Lecture that covers some of the notation in this article: LDA and Topic Modelling Video Lecture by David Blei or same lecture on YouTube 
       D. Mimno's LDA Bibliography An exhaustive list of LDA-related resources (incl. papers and some implementations) 
       Gensim, a Python+NumPy implementation of online LDA for inputs larger than the available RAM. 
       topicmodels and lda are two R packages for LDA analysis. 
       "Text Mining with R" including LDA methods, video presentation to the October 2011 meeting of the Los Angeles R users group 
       MALLET Open source Java-based package from the University of Massachusetts-Amherst for topic modeling with LDA, also has an independently developed GUI, the Topic Modeling Tool 
       LDA in Mahout implementation of LDA using MapReduce on the Hadoop platform 
       Latent Dirichlet Allocation (LDA) Tutorial for the Infer.NET Machine Computing Framework Microsoft Research C# Machine Learning Framework 
       LDA in Spark: Since version 1.3.0, Apache Spark also features an implementation of LDA 
       LDA, exampleLDA MATLAB implementation
       
      
       
      
      
       
        
         
          
           
            
             v
             t
             e
            
           
           
            Natural language processing
           
         
         
          General terms
          
            
            
             AI-complete 
             Bag-of-words 
             n-gram 
              
               Bigram 
               Trigram
               
             Computational linguistics 
             Natural-language understanding 
             Stop words 
             Text processing
             
           
         
         
          Text analysis
          
            
            
             Collocation extraction 
             Concept mining 
             Coreference resolution 
             Deep linguistic processing 
             Distant reading 
             Information extraction 
             Named-entity recognition 
             Ontology learning 
             Parsing 
             Part-of-speech tagging 
             Semantic role labeling 
             Semantic similarity 
             Sentiment analysis 
             Terminology extraction 
             Text mining 
             Textual entailment 
             Truecasing 
             Word-sense disambiguation 
             Word-sense induction
             
           
           
            
             
              Text segmentation
              
                
                
                 Compound-term processing 
                 Lemmatisation 
                 Lexical analysis 
                 Text chunking 
                 Stemming 
                 Sentence segmentation 
                 Word segmentation
                 
               
             
            
           
            
           
         
         
          Automatic summarization
          
            
            
             Multi-document summarization 
             Sentence extraction 
             Text simplification
             
           
         
         
          Machine translation
          
            
            
             Computer-assisted 
             Example-based 
             Rule-based 
             Statistical 
             Transfer-based 
             Neural
             
           
         
         
          Distributional semantics models
          
            
            
             BERT 
             Document-term matrix 
             Explicit semantic analysis 
             fastText 
             GloVe 
             Latent semantic analysis 
             Word embedding 
             Word2vec
             
           
         
         
          Language resources, datasets and corpora
          
           
           
            
             
              Types and standards
              
                
                
                 Corpus linguistics 
                 Lexical resource 
                 Linguistic Linked Open Data 
                 Machine-readable dictionary 
                 Parallel text 
                 PropBank 
                 Semantic network 
                 Simple Knowledge Organization System 
                 Speech corpus 
                 Text corpus 
                 Thesaurus (information retrieval) 
                 Treebank 
                 Universal Dependencies
                 
               
             
             
              Data
              
                
                
                 BabelNet 
                 Bank of English 
                 DBpedia 
                 FrameNet 
                 Google Ngram Viewer 
                 ThoughtTreasure 
                 UBY 
                 WordNet
                 
               
             
            
           
           
         
         
          Automatic identificationand data capture
          
            
            
             Speech recognition 
             Speech segmentation 
             Speech synthesis 
             Natural language generation 
             Optical character recognition
             
           
         
         
          Topic model
          
            
            
             Document classification 
             Latent Dirichlet allocation 
             Pachinko allocation
             
           
         
         
          Computer-assistedreviewing
          
            
            
             Automated essay scoring 
             Concordancer 
             Grammar checker 
             Predictive text 
             Spell checker 
             Syntax guessing
             
           
         
         
          Natural languageuser interface
          
            
            
             Chatbot 
             Interactive fiction 
             Question answering 
             Virtual assistant 
             Voice user interface
             
           
         
         
          Other software
          
            
            
             Natural Language Toolkit 
             spaCy
             
           
         
        
       
          
     
     
      
      
     
      Retrieved from "https://en.wikipedia.org/w/index.php?title=Latent_Dirichlet_allocation&amp;oldid=1070872766"
     
     
    
     
      Categories: 
      
       Statistical natural language processing
       Latent variable models
       Probabilistic models
      
     
     
      Hidden categories: 
      
       Articles with short description
       Short description is different from Wikidata
       Wikipedia articles that are too technical from August 2017
       All articles that are too technical
       Wikipedia external links cleanup from June 2016
       Wikipedia spam cleanup from June 2016
      
     
     
    
   
   
    
   
   
   Navigation menu 
    
     
      Personal tools  
      
      
       Not logged in
       Talk
       Contributions
       Create account
       Log in
       
      
     
     
      
       Namespaces  
       
       
        Article
        Talk
        
       
      
      
       
       Variants expanded collapsed  
       
        
       
      
     
     
      
       Views  
       
       
        Read
        Edit
        View history
        
       
      
      
       
       More expanded collapsed  
       
        
       
      
      
       
        Search  
        
         
          
          
          
          
         
        
       
      
     
    
    
      
     
     
      Navigation  
      
      
       Main page
       Contents
       Current events
       Random article
       About Wikipedia
       Contact us
       Donate
       
      
     
     
      Contribute  
      
      
       Help
       Learn to edit
       Community portal
       Recent changes
       Upload file
       
      
     
     
      Tools  
      
      
       What links here
       Related changes
       Upload file
       Special pages
       Permanent link
       Page information
       Cite this page
       Wikidata item
       
      
     
     
      Print/export  
      
      
       Download as PDF
       Printable version
       
      
     
     
      Languages  
      
      
       Català
       Deutsch
       Español
       فارسی
       Français
       한국어
       Português
       Română
       Русский
       Türkçe
       Tiếng Việt
       中文
       
      
       Edit links
       
      
     
    
   
   
    
     This page was last edited on 9 February 2022, at 18:28&nbsp;(UTC). 
    Text is available under the Creative Commons Attribution-ShareAlike License; additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy. Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc., a non-profit organization. 
    
    
    Privacy policy 
    About Wikipedia 
    Disclaimers 
    Contact Wikipedia 
    Mobile view 
    Developers 
    Statistics 
    Cookie statement 
    
    
     
     
    
   
   
   
    
 
